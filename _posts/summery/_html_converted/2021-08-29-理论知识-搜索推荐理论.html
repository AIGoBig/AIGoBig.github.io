<h3 id="gbdtlr">ğŸš©GBDT+LR</h3>
<p><strong>https://zhuanlan.zhihu.com/p/37522339</strong></p>
<p><strong>ä½¿ç”¨GBDTçš„å¥½å¤„</strong>ï¼šåˆ©ç”¨GBDTå¯ä»¥è‡ªåŠ¨è¿›è¡Œç‰¹å¾ç­›é€‰å’Œç‰¹å¾ç»„åˆï¼Œè¿›è€Œç”Ÿæˆæ–°çš„ç¦»æ•£ç‰¹å¾å‘é‡ã€‚å› ä¸ºå›å½’æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„åˆ†è£‚æ˜¯ä¸€ä¸ªè‡ªç„¶çš„ç‰¹å¾é€‰æ‹©çš„è¿‡ç¨‹ï¼Œè€Œå¤šå±‚èŠ‚ç‚¹çš„ç»“æ„åˆ™å¯¹ç‰¹å¾è¿›è¡Œäº†æœ‰æ•ˆåœ°è‡ªåŠ¨ç»„åˆã€‚æ‰€ä»¥å¯ä»¥éå¸¸é«˜æ•ˆåœ°è§£å†³æ£˜æ‰‹çš„ç‰¹å¾é€‰æ‹©å’Œç‰¹å¾ç»„åˆçš„é—®é¢˜ã€‚</p>
<p><strong>å®éªŒä¸­è®¾ç½®30æ£µæ ‘ï¼Œæ·±åº¦ä¸º8ã€‚æ¯é¢—æ ‘éƒ½ç›¸å½“äºä¸€ä¸ªç±»åˆ«ç‰¹å¾ï¼Œæ¯æ£µæ ‘çš„å¶å­ç»“ç‚¹æ•°ç›¸å½“äºç‰¹å¾å€¼çš„ä¸ªæ•°ã€‚</strong></p>
<ol type="1">
<li><strong>é¦–å…ˆå°†æ•°å€¼å‹çš„è¿ç»­ç‰¹å¾ä½œä¸ºlgbçš„è¾“å…¥</strong>ï¼Œï¼ˆå‡è®¾100æ£µæ ‘ï¼Œè®¾ç½®çš„å¶å­èŠ‚ç‚¹æ•°num_leaves=64ï¼‰ç„¶åè¿›è¡Œç‰¹å¾è½¬æ¢ã€‚</li>
</ol>
<ul>
<li>è®­ç»ƒGBDTæ¨¡å‹ æœ¬æ–‡ä½¿ç”¨lightgbmåŒ…æ¥è®­ç»ƒæˆ‘ä»¬çš„GBDTæ¨¡å‹ï¼Œè®­ç»ƒå…±100æ£µæ ‘ï¼Œæ¯æ£µæ ‘æœ‰64ä¸ªå¶å­ç»“ç‚¹ã€‚</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" data-line-number="1">df_train <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/train.csv&#39;</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">df_test <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/test.csv&#39;</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">NUMERIC_COLS <span class="op">=</span> [</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">    <span class="st">&quot;ps_reg_01&quot;</span>, <span class="st">&quot;ps_reg_02&quot;</span>, <span class="st">&quot;ps_reg_03&quot;</span>,</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">    <span class="st">&quot;ps_car_12&quot;</span>, <span class="st">&quot;ps_car_13&quot;</span>, <span class="st">&quot;ps_car_14&quot;</span>, <span class="st">&quot;ps_car_15&quot;</span>,</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">]</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="bu">print</span>(df_test.head(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">y_train <span class="op">=</span> df_train[<span class="st">&#39;target&#39;</span>]  <span class="co"># training label</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">y_test <span class="op">=</span> df_test[<span class="st">&#39;target&#39;</span>]  <span class="co"># testing label</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">X_train <span class="op">=</span> df_train[NUMERIC_COLS]  <span class="co"># training dataset</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">X_test <span class="op">=</span> df_test[NUMERIC_COLS]  <span class="co"># testing dataset</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co"># create dataset for lightgbm</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17">lgb_train <span class="op">=</span> lgb.Dataset(X_train, y_train)</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">lgb_eval <span class="op">=</span> lgb.Dataset(X_test, y_test, reference<span class="op">=</span>lgb_train)</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"></a>
<a class="sourceLine" id="cb1-20" data-line-number="20">params <span class="op">=</span> {</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">    <span class="st">&#39;task&#39;</span>: <span class="st">&#39;train&#39;</span>,</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">    <span class="st">&#39;boosting_type&#39;</span>: <span class="st">&#39;gbdt&#39;</span>,</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">    <span class="st">&#39;objective&#39;</span>: <span class="st">&#39;binary&#39;</span>,</a>
<a class="sourceLine" id="cb1-24" data-line-number="24">    <span class="st">&#39;metric&#39;</span>: {<span class="st">&#39;binary_logloss&#39;</span>},</a>
<a class="sourceLine" id="cb1-25" data-line-number="25">    <span class="st">&#39;num_leaves&#39;</span>: <span class="dv">64</span>,</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">    <span class="st">&#39;num_trees&#39;</span>: <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">    <span class="st">&#39;learning_rate&#39;</span>: <span class="fl">0.01</span>,</a>
<a class="sourceLine" id="cb1-28" data-line-number="28">    <span class="st">&#39;feature_fraction&#39;</span>: <span class="fl">0.9</span>,</a>
<a class="sourceLine" id="cb1-29" data-line-number="29">    <span class="st">&#39;bagging_fraction&#39;</span>: <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb1-30" data-line-number="30">    <span class="st">&#39;bagging_freq&#39;</span>: <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">    <span class="st">&#39;verbose&#39;</span>: <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32">}</a>
<a class="sourceLine" id="cb1-33" data-line-number="33"></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co"># number of leaves,will be used in feature transformation</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35">num_leaf <span class="op">=</span> <span class="dv">64</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="bu">print</span>(<span class="st">&#39;Start training...&#39;</span>)</a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co"># train</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39">gbm <span class="op">=</span> lgb.train(params,</a>
<a class="sourceLine" id="cb1-40" data-line-number="40">                lgb_train,</a>
<a class="sourceLine" id="cb1-41" data-line-number="41">                num_boost_round<span class="op">=</span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb1-42" data-line-number="42">                valid_sets<span class="op">=</span>lgb_train)</a>
<a class="sourceLine" id="cb1-43" data-line-number="43"></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"><span class="bu">print</span>(<span class="st">&#39;Save model...&#39;</span>)</a>
<a class="sourceLine" id="cb1-45" data-line-number="45"><span class="co"># save model to file</span></a>
<a class="sourceLine" id="cb1-46" data-line-number="46">gbm.save_model(<span class="st">&#39;model.txt&#39;</span>)</a>
<a class="sourceLine" id="cb1-47" data-line-number="47"></a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="bu">print</span>(<span class="st">&#39;Start predicting...&#39;</span>)</a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="co"># predict and get data on leaves, training data</span></a></code></pre></div>
<ul>
<li><strong>ç‰¹å¾è½¬æ¢</strong></li>
</ul>
<p>åœ¨è®­ç»ƒå¾—åˆ°100æ£µæ ‘ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°çš„ä¸æ˜¯GBDTçš„é¢„æµ‹ç»“æœï¼Œè€Œæ˜¯<strong>æ¯ä¸€æ¡è®­ç»ƒæ•°æ®è½åœ¨äº†æ¯æ£µæ ‘çš„å“ªä¸ªå¶å­ç»“ç‚¹ä¸Š</strong>ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ä¸‹é¢çš„è¯­å¥ï¼š</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" data-line-number="1">y_pred <span class="op">=</span> gbm.predict(X_train, pred_leaf<span class="op">=</span><span class="va">True</span>)</a></code></pre></div>
<p>æ‰“å°ä¸Šé¢ç»“æœçš„è¾“å‡ºï¼Œå¯ä»¥çœ‹åˆ°shapeæ˜¯(8001,100)ï¼Œå³è®­ç»ƒæ•°æ®é‡*æ ‘çš„æ£µæ ‘</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="bu">print</span>(np.array(y_pred).shape)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="bu">print</span>(y_pred[<span class="dv">0</span>]) <span class="co"># çœ‹ç¬¬ä¸€æ¡æ ·æœ¬çš„è¾“å‡ºï¼ŒåŒ…å«100é¢—æ•°çš„è¾“å‡ºèŠ‚ç‚¹ï¼Œå³æ¯ä¸ªæ ·æœ¬åœ¨ä¸åŒç±»åˆ«ç‰¹å¾ä¸Šçš„å–å€¼ã€‚</span></a></code></pre></div>
<p>ç»“æœä¸ºï¼š</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" data-line-number="1">(<span class="dv">8001</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">[[<span class="dv">43</span> <span class="dv">26</span> <span class="dv">47</span> <span class="dv">47</span> <span class="dv">47</span> <span class="dv">19</span> <span class="dv">36</span> <span class="dv">19</span> <span class="dv">50</span> <span class="dv">52</span> <span class="dv">29</span>  <span class="dv">0</span>  <span class="dv">0</span>  <span class="dv">0</span> <span class="dv">46</span> <span class="dv">23</span> <span class="dv">13</span> <span class="dv">27</span> <span class="dv">27</span> <span class="dv">13</span> <span class="dv">10</span> <span class="dv">22</span>  <span class="dv">0</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">   <span class="dv">4</span> <span class="dv">57</span> <span class="dv">17</span> <span class="dv">55</span> <span class="dv">54</span> <span class="dv">57</span> <span class="dv">59</span> <span class="dv">42</span> <span class="dv">22</span> <span class="dv">22</span> <span class="dv">22</span> <span class="dv">13</span>  <span class="dv">8</span>  <span class="dv">5</span> <span class="dv">27</span>  <span class="dv">5</span> <span class="dv">58</span> <span class="dv">23</span> <span class="dv">58</span> <span class="dv">14</span> <span class="dv">16</span> <span class="dv">16</span> <span class="dv">10</span> <span class="dv">32</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  <span class="dv">60</span> <span class="dv">32</span>  <span class="dv">4</span>  <span class="dv">4</span>  <span class="dv">4</span>  <span class="dv">4</span>  <span class="dv">4</span> <span class="dv">46</span> <span class="dv">57</span> <span class="dv">48</span> <span class="dv">57</span> <span class="dv">34</span> <span class="dv">54</span>  <span class="dv">6</span> <span class="dv">35</span>  <span class="dv">6</span>  <span class="dv">4</span> <span class="dv">55</span> <span class="dv">13</span> <span class="dv">23</span> <span class="dv">15</span> <span class="dv">51</span> <span class="dv">40</span>  <span class="dv">0</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="dv">47</span> <span class="dv">40</span> <span class="dv">10</span> <span class="dv">29</span> <span class="dv">24</span> <span class="dv">24</span> <span class="dv">31</span> <span class="dv">24</span> <span class="dv">55</span>  <span class="dv">3</span> <span class="dv">41</span>  <span class="dv">3</span> <span class="dv">22</span> <span class="dv">57</span>  <span class="dv">6</span>  <span class="dv">0</span>  <span class="dv">6</span>  <span class="dv">6</span> <span class="dv">57</span> <span class="dv">55</span> <span class="dv">57</span> <span class="dv">16</span> <span class="dv">12</span> <span class="dv">18</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  <span class="dv">30</span> <span class="dv">15</span> <span class="dv">17</span> <span class="dv">30</span>]]</a></code></pre></div>
<p><strong>å…¶å®å®éªŒä¸­åˆ°è¿™ä¸€æ­¥å°±å¯ä»¥äº†ï¼Œå¾—åˆ°äº†æ¯ä¸ªæ ·æœ¬è½åˆ°æ¯é¢—æ ‘çš„å¶å­èŠ‚ç‚¹ä½ç½®ï¼Œç›¸å½“äºè¿™æ ·æ ·æœ¬åœ¨æ¯ä¸ªç±»åˆ«ç‰¹å¾ä¸­çš„å–å€¼ã€‚</strong></p>
<hr />
<ul>
<li>ç„¶åæˆ‘ä»¬éœ€è¦å°†æ¯æ£µæ ‘çš„ç‰¹å¾è¿›è¡Œone-hotå¤„ç†ï¼Œå¦‚å‰é¢æ‰€è¯´ï¼Œå‡è®¾ç¬¬ä¸€æ£µæ ‘è½åœ¨43å·å¶å­ç»“ç‚¹ä¸Šï¼Œé‚£æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ª64ç»´çš„å‘é‡ï¼Œé™¤43ç»´ä¹‹å¤–å…¨éƒ¨éƒ½æ˜¯0ã€‚å› æ­¤ç”¨äºLRè®­ç»ƒçš„ç‰¹å¾ç»´æ•°å…±num_trees * num_leavesã€‚</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="bu">print</span>(<span class="st">&#39;Writing transformed training data&#39;</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">transformed_training_matrix <span class="op">=</span> np.zeros([<span class="bu">len</span>(y_pred), <span class="bu">len</span>(y_pred[<span class="dv">0</span>]) <span class="op">*</span> num_leaf],</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                                       dtype<span class="op">=</span>np.int64)  <span class="co"># N * num_tress * num_leafs</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(y_pred)):</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">    temp <span class="op">=</span> np.arange(<span class="bu">len</span>(y_pred[<span class="dv">0</span>])) <span class="op">*</span> num_leaf <span class="op">+</span> np.array(y_pred[I])</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">    transformed_training_matrix[i][temp] <span class="op">+=</span> <span class="dv">1</span></a></code></pre></div>
<ul>
<li>å½“ç„¶ï¼Œå¯¹äºæµ‹è¯•é›†ä¹Ÿè¦è¿›è¡ŒåŒæ ·çš„å¤„ç†:</li>
</ul>
<pre class="pyhton"><code>y_pred = gbm.predict(X_test, pred_leaf=True)
print(&#39;Writing transformed testing data&#39;)
transformed_testing_matrix = np.zeros([len(y_pred), len(y_pred[0]) * num_leaf], dtype=np.int64)
for i in range(0, len(y_pred)):
    temp = np.arange(len(y_pred[0])) * num_leaf + np.array(y_pred[I])
    transformed_testing_matrix[i][temp] += 1</code></pre>
<ul>
<li>LRè®­ç»ƒ ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨è½¬æ¢åçš„è®­ç»ƒé›†ç‰¹å¾å’Œlabelè®­ç»ƒæˆ‘ä»¬çš„LRæ¨¡å‹ï¼Œå¹¶å¯¹æµ‹è¯•é›†è¿›è¡Œæµ‹è¯•ï¼š</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb7-1" data-line-number="1">lm <span class="op">=</span> LogisticRegression(penalty<span class="op">=</span><span class="st">&#39;l2&#39;</span>,C<span class="op">=</span><span class="fl">0.05</span>) <span class="co"># logestic model construction</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">lm.fit(transformed_training_matrix,y_train)  <span class="co"># fitting the data</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">y_pred_test <span class="op">=</span> lm.predict_proba(transformed_testing_matrix)   <span class="co"># Give the probabilty on each label</span></a></code></pre></div>
<p>æˆ‘ä»¬è¿™é‡Œå¾—åˆ°çš„ä¸æ˜¯ç®€å•çš„ç±»åˆ«ï¼Œè€Œæ˜¯<strong>æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡</strong>ã€‚</p>
<h3 id="deepfmä»‹ç»">âœ…deepfmä»‹ç»</h3>
<p><a href="https://cloud.tencent.com/developer/article/1450677">ã€é€šä¿—æ˜“æ‡‚ã€‘æ‰‹æŠŠæ‰‹å¸¦ä½ å®ç°DeepFMï¼</a></p>
<p>DeepFM æ¨¡å‹åœ¨<strong>è§£å†³ç‰¹å¾äº¤å‰é—®é¢˜</strong>ä¸Šéå¸¸æœ‰ä¼˜åŠ¿ï¼Œå®ƒä¼šä½¿ç”¨ä¸€ä¸ªç‹¬ç‰¹çš„ FM å±‚æ¥ä¸“é—¨å¤„ç†ç‰¹å¾ä¹‹é—´çš„äº¤å‰é—®é¢˜ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯ä½¿ç”¨<strong>ç‚¹ç§¯ã€å…ƒç´ ç§¯</strong>ç­‰æ“ä½œè®©ä¸åŒç‰¹å¾ä¹‹é—´è¿›è¡Œä¸¤ä¸¤ç»„åˆï¼Œå†æŠŠç»„åˆåçš„ç»“æœè¾“å…¥çš„è¾“å‡ºç¥ç»å…ƒä¸­ï¼Œè¿™ä¼šå¤§å¤§åŠ å¼ºæ¨¡å‹ç‰¹å¾ç»„åˆçš„èƒ½åŠ›ã€‚å› æ­¤ï¼ŒDeepFM æ¨¡å‹ç›¸æ¯”äº Embedding MLPã€Wide&amp;Deep ç­‰æ¨¡å‹ï¼Œå¾€å¾€å…·æœ‰æ›´å¥½çš„æ¨èæ•ˆæœã€‚</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/4dbb2c9760199311b38b32a15daba176_20240315115906onl8pU.jpeg" alt="img" /><figcaption>img</figcaption>
</figure>
<ul>
<li><p>DeepFMåŒ…å«ä¸¤éƒ¨åˆ†<strong>ï¼šå› å­åˆ†è§£æœºéƒ¨åˆ†</strong>ä¸<strong>ç¥ç»ç½‘ç»œéƒ¨åˆ†</strong>ï¼Œåˆ†åˆ«è´Ÿè´£<strong>ä½é˜¶ç‰¹å¾çš„æå–</strong>å’Œ<strong>é«˜é˜¶ç‰¹å¾çš„æå–</strong>ã€‚è¿™ä¸¤éƒ¨åˆ†<strong>å…±äº«åŒæ ·çš„åµŒå…¥å±‚è¾“å…¥</strong>ã€‚</p></li>
<li><p>åµŒå…¥å±‚ï¼š ä¸»è¦æ ¹æ®<strong>ç‰¹å¾ç´¢å¼•</strong>å¾—åˆ°å¯¹åº”ç‰¹å¾çš„embeddingã€‚</p>
<blockquote>
<p>é€šè¿‡åµŒå…¥å±‚ï¼Œå°½ç®¡ä¸åŒfieldçš„é•¿åº¦ä¸åŒï¼ˆä¸åŒç¦»æ•£å˜é‡çš„å–å€¼ä¸ªæ•°å¯èƒ½ä¸åŒï¼‰ï¼Œ<strong>ä½†æ˜¯embeddingä¹‹åå‘é‡çš„é•¿åº¦å‡ä¸ºK</strong></p>
</blockquote></li>
<li><p>FMï¼š FMéƒ¨åˆ†æ˜¯ä¸€ä¸ªå› å­åˆ†è§£æœºã€‚å› ä¸º<strong>å¼•å…¥äº†éšå˜é‡</strong>çš„åŸå› ï¼Œå¯¹äºå‡ ä¹ä¸å‡ºç°æˆ–è€…å¾ˆå°‘å‡ºç°çš„éšå˜é‡ï¼ŒFMä¹Ÿå¯ä»¥å¾ˆå¥½çš„å­¦ä¹ ã€‚FMçš„<strong>è¾“å‡ºå…¬å¼</strong>åŒ…å«äº†çº¿æ€§é¡¹å’ŒäºŒé˜¶ç‰¹å¾é¡¹ï¼š <img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/1602764448337_20240315115915hwC66A.png" alt="FM" style="zoom:67%;" /></p></li>
<li><p>æ·±åº¦éƒ¨åˆ†ï¼š æ·±åº¦éƒ¨åˆ†æ˜¯ä¸€ä¸ª<strong>å¤šå±‚å‰é¦ˆç¥ç»ç½‘ç»œ</strong>ã€‚å…¶ä¸­ä½¿ç”¨reluä½œä¸ºç½‘ç»œçš„æ¿€æ´»å‡½æ•°ï¼Œè¾“å‡ºå±‚ä½¿ç”¨sigmoidä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚</p></li>
<li><p>DeepFMçš„<strong>é¢„æµ‹ç»“æœ</strong>å¯ä»¥å†™ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210703231952611-0044321_20240315115916PXJel3.png" alt="image-20210703231952611" style="zoom:25%;" /></p></li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210703231615635_20240315115917bZ3NnQ.png" alt="image-20210703231615635" style="zoom: 25%;" /></p>
<h4 id="embeddingä»‹ç»">Embeddingä»‹ç»</h4>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210703232513030_20240315115918eZtRyQ.png" alt="image-20210703232513030" style="zoom:50%;" /></p>
<p>åµŒå…¥å±‚(embedding layer)çš„ç»“æ„å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚é€šè¿‡åµŒå…¥å±‚ï¼Œå°½ç®¡ä¸åŒfieldçš„é•¿åº¦ä¸åŒï¼ˆä¸åŒç¦»æ•£å˜é‡çš„å–å€¼ä¸ªæ•°å¯èƒ½ä¸åŒï¼‰ï¼Œ<strong>ä½†æ˜¯embeddingä¹‹åå‘é‡çš„é•¿åº¦å‡ä¸ºK</strong>ï¼ˆæˆ‘ä»¬æå‰è®¾å®šå¥½çš„embedding-size)ã€‚é€šè¿‡ä»£ç å¯ä»¥å‘ç°ï¼Œåœ¨å¾—åˆ°embeddingä¹‹åï¼Œæˆ‘ä»¬è¿˜å°†å¯¹åº”çš„<strong>ç‰¹å¾å€¼</strong>ä¹˜åˆ°äº†embeddingä¸Šï¼Œè¿™ä¸»è¦æ˜¯ç”±äºfméƒ¨åˆ†å’Œdnnéƒ¨åˆ†å…±äº«åµŒå…¥å±‚ä½œä¸ºè¾“å…¥ï¼Œè€Œfmä¸­çš„äºŒæ¬¡é¡¹å¦‚ä¸‹ï¼šğŸš©</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210703232532535-0044322_20240315115919Gp3i8t.png" alt="image-20210703232532535" style="zoom: 25%;" /></p>
<blockquote>
<p>Vi,vjæ˜¯embeddingå‘é‡ï¼ˆå†…ç§¯ï¼‰ï¼Œxj1Â·xj2æ˜¯ç‰¹å¾å€¼ï¼Œè‹¥ï¼š</p>
<ol type="1">
<li>ç±»åˆ«å‘é‡ï¼š xji æ˜¯ç±»åˆ«å‘é‡ï¼Œxjiå–1</li>
<li>æ•°å€¼ç‰¹å¾ï¼šæŒ‰åŸæ¥å–å€¼</li>
</ol>
</blockquote>
<p>DeepFMä¸­ï¼Œå¾ˆé‡è¦çš„ä¸€é¡¹å°±æ˜¯embeddingæ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯embeddingï¼Œå¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼Œ<strong>å°†ä¸€ä¸ªç‰¹å¾è½¬æ¢ä¸ºä¸€ä¸ªå‘é‡</strong>ã€‚</p>
<blockquote>
<p>åœ¨æ¨èç³»ç»Ÿå½“ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°<strong>ç¦»æ•£å˜é‡</strong>ï¼Œå¦‚useridã€itemidã€‚å¯¹äºç¦»æ•£å˜é‡ï¼Œæˆ‘ä»¬ä¸€èˆ¬çš„åšæ³•æ˜¯å°†å…¶è½¬æ¢ä¸ºone-hotï¼Œä½†å¯¹äºitemidè¿™ç§ç¦»æ•£å˜é‡ï¼Œè½¬æ¢æˆone-hotä¹‹å<strong>ç»´åº¦éå¸¸é«˜</strong>ï¼Œä½†é‡Œé¢åªæœ‰ä¸€ä¸ªæ˜¯1ï¼Œå…¶ä½™éƒ½ä¸º0ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„é€šå¸¸åšæ³•å°±æ˜¯å°†å…¶è½¬æ¢ä¸º<strong>embedding</strong>ã€‚</p>
</blockquote>
<p>embeddingçš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿå®ƒå…¶å®å°±æ˜¯ä¸€å±‚<strong>å…¨è¿æ¥çš„ç¥ç»ç½‘ç»œ</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210704092830904-0044322_20240315115920IEbxCk.png" alt="image-20210704092830904" style="zoom: 25%;" /></p>
<blockquote>
<p>å‡è®¾ä¸€ä¸ªç¦»æ•£å˜é‡å…±æœ‰5ä¸ªå–å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´one-hotä¹‹åä¼šå˜æˆ5ç»´ï¼Œæˆ‘ä»¬æƒ³å°†å…¶è½¬æ¢ä¸ºembeddingè¡¨ç¤ºï¼Œå…¶å®å°±æ˜¯æ¥å…¥äº†ä¸€å±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œã€‚ç”±äºåªæœ‰ä¸€ä¸ªä½ç½®æ˜¯1ï¼Œå…¶ä½™ä½ç½®æ˜¯0ï¼Œå› æ­¤å¾—åˆ°çš„<u>embeddingå°±æ˜¯ä¸å…¶ç›¸è¿çš„å›¾ä¸­çº¢çº¿ä¸Šçš„<strong>æƒé‡</strong>ã€‚</u></p>
</blockquote>
<h4 id="tf.nn.embedding_lookupå‡½æ•°ä»‹ç»">tf.nn.embedding_lookupå‡½æ•°ä»‹ç»</h4>
<p>åœ¨tf1.xä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>embedding_lookup</code>å‡½æ•°æ¥å®ç°embeddingï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb8-1" data-line-number="1">get_embedding1 <span class="op">=</span> tf.nn.embedding_lookup(embedding,feature_batch)</a></code></pre></div>
<blockquote>
<p>åœ¨embedding_lookupä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç›¸å½“äºä¸€ä¸ªäºŒç»´çš„è¯è¡¨ï¼Œå¹¶æ ¹æ®ç¬¬äºŒä¸ªå‚æ•°ä¸­æŒ‡å®šçš„ç´¢å¼•ï¼Œå»è¯è¡¨ä¸­å¯»æ‰¾å¹¶è¿”å›å¯¹åº”çš„è¡Œã€‚ä¸Šé¢çš„è¿‡ç¨‹ä¸ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210704151508258_20240315115921RlblFO.png" alt="image-20210704151508258" />å› æ­¤ï¼Œä½¿ç”¨embedding_lookupçš„è¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦å°†æ•°æ®è½¬æ¢ä¸ºone-hotå½¢å¼ï¼Œåªéœ€è¦ä¼ å…¥å¯¹åº”çš„featureçš„indexå³å¯ã€‚</p>
</blockquote>
<h4 id="æ•°æ®å¤„ç†">æ•°æ®å¤„ç†</h4>
<p>æ¥ä¸‹æ¥è¿›å…¥ä»£ç å®æˆ˜éƒ¨åˆ†ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹æ•°æ®å¤„ç†éƒ¨åˆ†ï¼Œé€šè¿‡åˆšæ‰çš„è®²è§£ï¼Œæƒ³è¦ç»™æ¯ä¸€ä¸ªç‰¹å¾å¯¹åº”ä¸€ä¸ªkç»´çš„embeddingï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨embedding_lookupçš„è¯ï¼Œéœ€è¦<strong>å¾—åˆ°è¿ç»­å˜é‡æˆ–è€…ç¦»æ•£å˜é‡å¯¹åº”çš„ç‰¹å¾ç´¢å¼•feature index</strong>ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶å…±æœ‰5ä¸ªfieldï¼Œä¸€ä¸ªè¿ç»­ç‰¹å¾å°±å¯¹åº”ä¸€ä¸ªfieldã€‚</p>
<p>ä½†æ˜¯åœ¨FMçš„å…¬å¼ä¸­ï¼Œä¸å…‰æ˜¯embeddingçš„å†…ç§¯ï¼Œç‰¹å¾å–å€¼ä¹ŸåŒæ ·éœ€è¦ã€‚<strong>å¯¹äºç¦»æ•£å˜é‡æ¥è¯´ï¼Œç‰¹å¾å–å€¼å°±æ˜¯1ï¼Œå¯¹äºè¿ç»­å˜é‡æ¥è¯´ï¼Œç‰¹å¾å–å€¼æ˜¯å…¶æœ¬èº«</strong>ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æƒ³è¦å¾—åˆ°çš„æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210704153224321_20240315115922ovVvEd.png" alt="image-20210704153224321" style="zoom: 25%;" /></p>
<p>éƒ¨åˆ†æ•°æ®é›†å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210704160448652-0044323_20240315115923KnpBTb.png" alt="image-20210704160322600" style="zoom: 25%;" /></p>
<p>æ¥ä¸‹æ¥ï¼Œæƒ³è¦å¾—åˆ°ä¸€ä¸ªfeature-mapã€‚<u>è¿™ä¸ª<strong>featrue-map</strong>å®šä¹‰äº†å¦‚ä½•å°†å˜é‡çš„ä¸åŒå–å€¼è½¬æ¢ä¸ºå…¶å¯¹åº”çš„ç‰¹å¾ç´¢å¼•feature-index</u>ã€‚</p>
<p>å®šä¹‰äº†<strong>total_feature</strong>æ¥å¾—åˆ°æ€»çš„ç‰¹å¾æ•°é‡ï¼Œå®šä¹‰äº†<strong>feature_dict</strong>æ¥å¾—åˆ°å˜é‡å–å€¼åˆ°ç‰¹å¾ç´¢å¼•çš„å¯¹åº”å…³ç³»ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºè¿ç»­å˜é‡ï¼Œç›´æ¥æ˜¯å˜é‡ååˆ°ç´¢å¼•çš„æ˜ å°„ï¼Œå¯¹äºç¦»æ•£å˜é‡ï¼Œå†…éƒ¨ä¼šåµŒå¥—ä¸€ä¸ªäºŒçº§mapï¼Œè¿™ä¸ªäºŒçº§mapå®šä¹‰äº†è¯¥ç¦»æ•£å˜é‡çš„ä¸åŒå–å€¼åˆ°ç´¢å¼•çš„æ˜ å°„ã€‚</p>
<p>ä¸‹ä¸€æ­¥ï¼Œéœ€è¦å°†è®­ç»ƒé›†å’Œæµ‹è¯•é›†è½¬æ¢ä¸ºä¸¤ä¸ªæ–°çš„æ•°ç»„ï¼Œåˆ†åˆ«æ˜¯feature-indexï¼Œå°†æ¯ä¸€æ¡æ•°æ®è½¬æ¢ä¸ºå¯¹åº”çš„ç‰¹å¾ç´¢å¼•ï¼Œä»¥åŠfeature-valueï¼Œå°†æ¯ä¸€æ¡æ•°æ®è½¬æ¢ä¸ºå¯¹åº”çš„ç‰¹å¾å€¼ã€‚</p>
<p>æ­¤æ—¶çš„è®­ç»ƒé›†çš„ç‰¹å¾ç´¢å¼•ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210704160448652-0044323_20240315115923KnpBTb.png" alt="image-20210704160448652" style="zoom: 25%;" /></p>
<blockquote>
<p>ç‰¹å¾å€¼ï¼šç¦»æ•£å˜é‡ç‰¹å¾å–å€¼ä¸º1ï¼Œè¿ç»­å˜é‡ç‰¹å¾å–å€¼ä¸ºæœ¬èº«</p>
</blockquote>
<h4 id="æ¨¡å‹å‚æ•°åŠè¾“å…¥">æ¨¡å‹å‚æ•°åŠè¾“å…¥</h4>
<p>æ¥ä¸‹æ¥å®šä¹‰æ¨¡å‹çš„ä¸€äº›<strong>å‚æ•°</strong>ï¼Œå¦‚ï¼šå­¦ä¹ ç‡(0.001)ã€embeddingçš„å¤§å°ï¼ˆ8ï¼‰ã€æ·±åº¦ç½‘ç»œçš„å‚æ•°ï¼ˆEpoch:30 batch_size:1024 Optimizerï¼šadamï¼‰ã€æ¿€æ´»å‡½æ•°ï¼ˆtf.nn.reluï¼‰ç­‰ç­‰ï¼Œè¿˜æœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯featureçš„å¤§å°å’Œfieldçš„å¤§å°ï¼š</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co">&quot;&quot;&quot;æ¨¡å‹å‚æ•°&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">dfm_params <span class="op">=</span> {</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">    <span class="st">&quot;use_fm&quot;</span>:<span class="va">True</span>,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    <span class="st">&quot;use_deep&quot;</span>:<span class="va">True</span>,</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">    <span class="st">&quot;embedding_size&quot;</span>:<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    <span class="st">&quot;dropout_fm&quot;</span>:[<span class="fl">1.0</span>,<span class="fl">1.0</span>],</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    <span class="st">&quot;deep_layers&quot;</span>:[<span class="dv">32</span>,<span class="dv">32</span>],</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    <span class="st">&quot;dropout_deep&quot;</span>:[<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>],</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    <span class="st">&quot;deep_layer_activation&quot;</span>:tf.nn.relu,</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">    <span class="st">&quot;epoch&quot;</span>:<span class="dv">30</span>,</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">    <span class="st">&quot;batch_size&quot;</span>:<span class="dv">1024</span>,</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">    <span class="st">&quot;learning_rate&quot;</span>:<span class="fl">0.001</span>,</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">    <span class="st">&quot;optimizer&quot;</span>:<span class="st">&quot;adam&quot;</span>,</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">    <span class="st">&quot;batch_norm&quot;</span>:<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">    <span class="st">&quot;batch_norm_decay&quot;</span>:<span class="fl">0.995</span>,</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">    <span class="st">&quot;l2_reg&quot;</span>:<span class="fl">0.01</span>,</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">    <span class="st">&quot;verbose&quot;</span>:<span class="va">True</span>,</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">    <span class="st">&quot;eval_metric&quot;</span>:<span class="st">&#39;gini_norm&#39;</span>,</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">    <span class="st">&quot;random_seed&quot;</span>:<span class="dv">3</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20">}</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">dfm_params[<span class="st">&#39;feature_size&#39;</span>] <span class="op">=</span> total_feature</a>
<a class="sourceLine" id="cb9-22" data-line-number="22">dfm_params[<span class="st">&#39;field_size&#39;</span>] <span class="op">=</span> <span class="bu">len</span>(train_feature_index.columns)</a></code></pre></div>
<p>è€Œ<strong>è®­ç»ƒæ¨¡å‹çš„è¾“å…¥</strong>æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯åˆšæ‰è½¬æ¢å¾—åˆ°çš„<strong>ç‰¹å¾ç´¢å¼•å’Œç‰¹å¾å€¼ï¼Œä»¥åŠlabel</strong>ï¼š</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="st">&quot;&quot;&quot;å¼€å§‹å»ºç«‹æ¨¡å‹&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">feat_index <span class="op">=</span> <span class="va">tf</span>.<span class="at">placeholder</span>(<span class="va">tf</span>.<span class="at">int32</span><span class="op">,</span>shape<span class="op">=</span>[None<span class="op">,</span>None]<span class="op">,</span>name<span class="op">=</span><span class="st">&#39;feat_index&#39;</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">feat_value <span class="op">=</span> <span class="va">tf</span>.<span class="at">placeholder</span>(<span class="va">tf</span>.<span class="at">float32</span><span class="op">,</span>shape<span class="op">=</span>[None<span class="op">,</span>None]<span class="op">,</span>name<span class="op">=</span><span class="st">&#39;feat_value&#39;</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">label <span class="op">=</span> <span class="va">tf</span>.<span class="at">placeholder</span>(<span class="va">tf</span>.<span class="at">float32</span><span class="op">,</span>shape<span class="op">=</span>[None<span class="op">,</span><span class="dv">1</span>]<span class="op">,</span>name<span class="op">=</span><span class="st">&#39;label&#39;</span>)</a></code></pre></div>
<p>å®šä¹‰å¥½è¾“å…¥ä¹‹åï¼Œå†å®šä¹‰ä¸€ä¸‹<strong>æ¨¡å‹ä¸­æ‰€éœ€è¦çš„weights</strong>ï¼š</p>
<p>ä»‹ç»ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„å‚æ•°ï¼š</p>
<ul>
<li>weights[â€˜feature_embeddingsâ€™]æ˜¯<strong>æ¯ä¸ªç‰¹å¾æ‰€å¯¹åº”çš„embedding</strong>ï¼Œå®ƒçš„å¤§å°ä¸ºfeature-size * embedding-sizeï¼Œ</li>
<li>weights[â€˜feature_biasâ€™] ï¼Œè¿™ä¸ªæ˜¯FMéƒ¨åˆ†è®¡ç®—æ—¶æ‰€ç”¨åˆ°çš„<strong>ä¸€æ¬¡é¡¹çš„æƒé‡å‚æ•°</strong>ï¼Œå¯ä»¥ç†è§£ä¸ºembedding-sizeä¸º1çš„embedding tableï¼Œå®ƒçš„å¤§å°ä¸ºfeature-size * 1ã€‚</li>
</ul>
<h4 id="åµŒå…¥å±‚">2.5 åµŒå…¥å±‚</h4>
<p>åµŒå…¥å±‚ï¼Œä¸»è¦æ ¹æ®ç‰¹å¾ç´¢å¼•å¾—åˆ°å¯¹åº”ç‰¹å¾çš„embeddingï¼š</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="st">&quot;&quot;&quot;embedding&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">embeddings <span class="op">=</span> <span class="va">tf</span>.<span class="va">nn</span>.<span class="at">embedding_lookup</span>(weights[<span class="st">&#39;feature_embeddings&#39;</span>]<span class="op">,</span>feat_index)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">reshaped_feat_value <span class="op">=</span> <span class="va">tf</span>.<span class="at">reshape</span>(feat_value<span class="op">,</span>shape<span class="op">=</span>[<span class="op">-</span><span class="dv">1</span><span class="op">,</span>dfm_params[<span class="st">&#39;field_size&#39;</span>]<span class="op">,</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">embeddings <span class="op">=</span> <span class="va">tf</span>.<span class="at">multiply</span>(embeddings<span class="op">,</span>reshaped_feat_value)</a></code></pre></div>
<p>è¿™é‡Œæ³¨æ„çš„æ˜¯ï¼Œåœ¨<strong>å¾—åˆ°å¯¹åº”çš„embeddingä¹‹åï¼Œè¿˜ä¹˜ä¸Šäº†å¯¹åº”çš„ç‰¹å¾å€¼</strong>ï¼Œè¿™ä¸ªä¸»è¦æ˜¯æ ¹æ®FMçš„å…¬å¼å¾—åˆ°çš„ã€‚è¿‡ç¨‹è¡¨ç¤ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210704175531989-0044322_20240315115924YoFmij.png" alt="image-20210704175531989" style="zoom:25%;" /></p>
<h4 id="fméƒ¨åˆ†">FMéƒ¨åˆ†</h4>
<p>æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹FMçš„å…¬å¼ï¼Œåœ¨ä¼ ç»Ÿçš„ä¸€é˜¶çº¿æ€§å›å½’ä¹‹ä¸Šï¼ŒåŠ äº†ä¸€ä¸ªäºŒæ¬¡é¡¹ï¼Œå¯ä»¥è¡¨è¾¾ä¸¤ä¸¤ç‰¹å¾çš„ç›¸äº’å…³ç³»ã€‚</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/1602764448337_20240315115915hwC66A.png" alt="FM" /><figcaption>FM</figcaption>
</figure>
<p>åœ¨ä¼ ç»Ÿçš„ä¸€é˜¶çº¿æ€§å›å½’ä¹‹ä¸Šï¼ŒåŠ äº†ä¸€ä¸ªäºŒæ¬¡é¡¹ï¼Œå¯ä»¥è¡¨è¾¾ä¸¤ä¸¤ç‰¹å¾çš„ç›¸äº’å…³ç³»ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/1602764632765_20240315115925IdTRnC.png" alt="ç‰¹å¾ç›¸äº’å…³ç³»" style="zoom:67%;" /></p>
<p>è¿™é‡Œçš„å…¬å¼å¯ä»¥ç®€åŒ–ï¼Œå‡å°‘è®¡ç®—é‡ï¼Œ</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/1602765047458_20240315115926BTJrGP.png" alt="FM" /><figcaption>FM</figcaption>
</figure>
<h4 id="deepéƒ¨åˆ†">Deepéƒ¨åˆ†</h4>
<p>Deepéƒ¨åˆ†å¾ˆç®€å•äº†ï¼Œå°±æ˜¯å¤šå±‚å…¨è¿æ¥ç½‘ç»œã€‚</p>
<h4 id="è¾“å‡ºéƒ¨åˆ†">è¾“å‡ºéƒ¨åˆ†</h4>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210704194711291-0044322_202403151159273ApgpV.png" alt="image-20210704194711291" style="zoom: 15%;" /></p>
<h4 id="deepfmçš„å®ç°æµç¨‹">ğŸš©Deepfmçš„å®ç°æµç¨‹</h4>
<ol type="1">
<li><strong>å¯¼å…¥åŒ…ï¼›è¯»å–æ•°æ®ï¼›å®šä¹‰ç¨€ç–ç‰¹å¾ï¼ˆç±»åˆ«ç‰¹å¾ï¼‰å’Œç¨ å¯†ç‰¹å¾ï¼ˆè¿ç»­ç‰¹å¾ï¼‰ï¼›å¯¹ç©ºå€¼è¿›è¡Œå¤„ç†ï¼Œç¨€ç–ç‰¹å¾â€™-1â€™å¡«å……ï¼Œ ç¨ å¯†ç‰¹å¾ç”¨0å¡«å……ã€‚</strong></li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder, MinMaxScaler</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="im">from</span> deepctr.models <span class="im">import</span> DeepFM</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="im">from</span> deepctr.feature_column <span class="im">import</span> SparseFeat, DenseFeat,get_feature_names</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">data <span class="op">=</span> pd.read_csv(<span class="st">&#39;./criteo_sample.txt&#39;</span>) <span class="co">#è¯»å–æ•°æ®</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">sparse_features <span class="op">=</span> [<span class="st">&#39;C&#39;</span> <span class="op">+</span> <span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">27</span>)] <span class="co">#ç¨€ç–ç‰¹å¾ä¸€èˆ¬æ˜¯ç±»åˆ«ç‰¹å¾</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10">dense_features <span class="op">=</span> [<span class="st">&#39;I&#39;</span><span class="op">+</span><span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">14</span>)]</a>
<a class="sourceLine" id="cb12-11" data-line-number="11"></a>
<a class="sourceLine" id="cb12-12" data-line-number="12">data[sparse_features] <span class="op">=</span> data[sparse_features].fillna(<span class="st">&#39;-1&#39;</span>, ) <span class="co"># fillnaæ˜¯å¯¹ç©ºå€¼çš„å¡«å……å¤„ç†å‡½æ•°</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13">data[dense_features] <span class="op">=</span> data[dense_features].fillna(<span class="dv">0</span>,)</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">target <span class="op">=</span> [<span class="st">&#39;label&#39;</span>] </a></code></pre></div>
<ol start="2" type="1">
<li><strong>æ•°æ®é¢„å¤„ç†ï¼šç¥ç»ç½‘ç»œè¾“å…¥çš„éƒ½æ˜¯æ•°å­—ï¼Œå› æ­¤éœ€è¦å¯¹ç±»åˆ«ç‰¹å¾è¿›è¡Œç¼–ç ï¼ŒLabelEncoderã€‚</strong></li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="cf">for</span> feat <span class="kw">in</span> sparse_features:</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">    lbe <span class="op">=</span> LabelEncoder()</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">    data[feat] <span class="op">=</span> lbe.fit_transform(data[feat])</a></code></pre></div>
<ol start="3" type="1">
<li><strong>ç”Ÿæˆç‰¹å¾åˆ—ï¼šå°†ç±»åˆ«ç‰¹å¾é€šè¿‡åµŒå…¥æŠ€æœ¯å°†å…¶è½¬åŒ–æˆç¨ å¯†å‘é‡ï¼Œä¸ç¨ å¯†ç‰¹å¾ä¸€èµ·æ‹¼æ¥ï¼Œä½œä¸ºç¥ç»ç½‘ç»œçš„è¾“å…¥å‘é‡ã€‚</strong></li>
</ol>
<p>ç¨ å¯†ç‰¹å¾åªæœ‰ä¸€ä¸ªå–å€¼ï¼Œ<strong>ç–‘é—®ï¼šç¨ å¯†ç‰¹å¾æ€ä¹ˆè®¡ç®—embeddingï¼Ÿ</strong>ç­”ï¼šåœ¨å¾—åˆ°å¯¹åº”çš„embeddingä¹‹åï¼Œè¿˜ä¹˜ä¸Šäº†å¯¹åº”çš„ç‰¹å¾å€¼ï¼Œè¿™ä¸ªä¸»è¦æ˜¯æ ¹æ®FMçš„å…¬å¼å¾—åˆ°çš„ã€‚å¯¹äºç±»åˆ«ç‰¹å¾ä¹˜çš„å€¼æ˜¯1ï¼Œå¯¹äºç¨ å¯†ç‰¹å¾æ¥è¯´éœ€è¦ä¹˜çš„å€¼æ˜¯ç‰¹å¾å€¼50/100/â€¦ï¼Œæ‰€ä»¥å¯¹æ¯ä¸ªç¨ å¯†ç‰¹å¾ç›¸å½“äºæ„é€ äº†ä¸€ä¸ª1*kçš„embeddingå‘é‡ï¼Œåªä¸è¿‡ä¸åŒçš„å–å€¼éœ€è¦å¯¹embeddingå‘é‡ä¹˜ç‰¹å¾å€¼ã€‚</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># æ ‡ç­¾ç¼–ç </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">fixlen_feature_columns <span class="op">=</span> [SparseFeat(feat, vocabulary_size<span class="op">=</span>data[feat].<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>,embedding_dim<span class="op">=</span><span class="dv">4</span>) <span class="co"># è®¾ç½®embeddingç»´åº¦8</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">                       <span class="cf">for</span> i,feat <span class="kw">in</span> <span class="bu">enumerate</span>(sparse_features)] <span class="op">\</span> <span class="co"># å› ä¸ºä¹‹å‰ç¼–ç ä»0å¼€å§‹ï¼Œæ‰€ä»¥ç‰¹å¾å€¼çš„ä¸ªæ•°ä¸ºdata[feat].max()+1</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">                        <span class="op">+</span> [DenseFeat(feat, <span class="dv">1</span>,) <span class="cf">for</span> feat <span class="kw">in</span> dense_features]  <span class="co"># ç¨ å¯†ç‰¹å¾åªæœ‰ä¸€ä¸ªå–å€¼ï¼Œç–‘é—®ï¼šç¨ å¯†ç‰¹å¾æ€ä¹ˆè®¡ç®—embeddingï¼Ÿ</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co"># æˆ–è€…</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7">fixlen_feature_columns <span class="op">=</span> [SparseFeat(feat, data[feat].nunique())</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">                          <span class="cf">for</span> feat <span class="kw">in</span> sparse_features] <span class="op">+</span> [DenseFeat(feat, <span class="dv">1</span>, ) <span class="cf">for</span> feat <span class="kw">in</span> dense_features]</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#ç”Ÿæˆç‰¹å¾åˆ—</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">dnn_feature_columns <span class="op">=</span> fixlen_feature_columns  <span class="co">#ç”¨åšdnnçš„è¾“å…¥å‘é‡</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">linear_feature_columns <span class="op">=</span> fixlen_feature_columns <span class="co">#ç”¨åœ¨çº¿æ€§æ¨¡å‹çš„è¾“å…¥ç‰¹å¾</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#è·å–æ‰€æœ‰ç‰¹å¾çš„åå­—</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15">feature_names <span class="op">=</span> get_feature_names(linear_feature_columns <span class="op">+</span> dnn_feature_columns) </a></code></pre></div>
<ol start="4" type="1">
<li><strong>ç”Ÿæˆè®­ç»ƒæ ·æœ¬å’Œæ¨¡å‹</strong></li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb15-1" data-line-number="1">train, test <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.2</span>) <span class="co">#æŒ‰ç…§8:2çš„æ¯”ä¾‹åˆ’åˆ†æ•°æ®é›†ä¸ºè®­ç»ƒé›†åˆæµ‹è¯•é›†</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">train_model_input <span class="op">=</span> {name:train[name].values <span class="cf">for</span> name <span class="kw">in</span> feature_names} </a>
<a class="sourceLine" id="cb15-4" data-line-number="4">test_model_input <span class="op">=</span> {name:test[name].values <span class="cf">for</span> name <span class="kw">in</span> feature_names}</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6">model <span class="op">=</span> DeepFM(linear_feature_columns, dnn_feature_columns, embedding_size<span class="op">=</span><span class="dv">8</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">               use_fm<span class="op">=</span><span class="va">True</span>, dnn_hidden_units<span class="op">=</span>(<span class="dv">256</span>, <span class="dv">256</span>, <span class="dv">256</span>), l2_reg_linear<span class="op">=</span><span class="fl">0.001</span>,</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">               l2_reg_embedding<span class="op">=</span><span class="fl">0.001</span>, l2_reg_dnn<span class="op">=</span><span class="dv">0</span>, init_std<span class="op">=</span><span class="fl">0.0001</span>, seed<span class="op">=</span><span class="dv">1024</span>,</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">              dnn_dropout<span class="op">=</span><span class="fl">0.5</span>, dnn_activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, dnn_use_bn<span class="op">=</span><span class="va">True</span>, task<span class="op">=</span><span class="st">&#39;binary&#39;</span>) <span class="co">#è°ƒç”¨deepctråº“ä¸­çš„DeepFMæ¨¡å‹ï¼Œæ‰§è¡ŒäºŒåˆ†ç±»ä»»åŠ¡</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"></a>
<a class="sourceLine" id="cb15-11" data-line-number="11">model.<span class="bu">compile</span>(<span class="st">&quot;adam&quot;</span>, <span class="st">&quot;binary_crossentropy&quot;</span>,</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">              metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;AUC&#39;</span>], ) <span class="co">#è®¾ç½®ä¼˜åŒ–å™¨ï¼ŒæŸå¤±å‡½æ•°ç±»å‹å’Œè¯„ä¼°æŒ‡æ ‡</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"></a>
<a class="sourceLine" id="cb15-14" data-line-number="14">history <span class="op">=</span> model.fit(train_model_input, train[target].values,</a>
<a class="sourceLine" id="cb15-15" data-line-number="15">                    batch_size<span class="op">=</span><span class="dv">256</span>, epochs<span class="op">=</span><span class="dv">10</span>, verbose<span class="op">=</span><span class="dv">2</span>, validation_split<span class="op">=</span><span class="fl">0.2</span>, ) <span class="co">#fitæ•°æ®</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16">pred_ans <span class="op">=</span> model.predict(test_model_input, batch_size<span class="op">=</span><span class="dv">256</span>) <span class="co"># é¢„æµ‹</span></a></code></pre></div>
<h3 id="deepfmé¢è¯•é—®é¢˜">deepfmé¢è¯•é—®é¢˜</h3>
<h4 id="deepfmçš„ä¼˜ç‚¹æœ‰å“ªäº›">deepfmçš„ä¼˜ç‚¹æœ‰å“ªäº›</h4>
<p>1ã€DeepFMï¼ˆFM Component + Deep Componentï¼‰åŒ…å«ä¸¤éƒ¨åˆ†ï¼šå› å­åˆ†è§£æœºï¼ˆFMï¼‰éƒ¨åˆ†ä¸ï¼ˆDNNï¼‰éƒ¨åˆ†ï¼ŒFMéƒ¨åˆ†è´Ÿè´£<strong>ä½é˜¶ç‰¹å¾çš„æå–</strong>ï¼ˆåŒ…æ‹¬ä¸€é˜¶å’ŒäºŒé˜¶ï¼Œè™½ç„¶FMä¹Ÿå¯ä»¥å®ç°é«˜äºäºŒé˜¶çš„ç‰¹å¾æå–ï¼Œä½†æ˜¯ç”±äºè®¡ç®—å¤æ‚åº¦çš„é™åˆ¶ï¼Œä¸€èˆ¬åªè®¡ç®—åˆ°äºŒé˜¶ï¼‰ï¼Œ<strong>DNNéƒ¨åˆ†è´Ÿè´£é«˜é˜¶ç‰¹å¾çš„æå–</strong>ï¼Œè¿™æ ·<strong>å¯ä»¥é¿å…äººå·¥æ„é€ å¤æ‚çš„ç‰¹å¾å·¥ç¨‹ã€‚</strong></p>
<p>2ã€<strong>å…±äº«feature embedding</strong>ã€‚FMå’ŒDeepå…±äº«è¾“å…¥å’Œfeature embeddingä¸ä½†ä½¿å¾—<strong>è®­ç»ƒæ›´å¿«</strong>ï¼Œè€Œä¸”ä½¿å¾—<strong>è®­ç»ƒæ›´åŠ å‡†ç¡®</strong>ã€‚</p>
<h4 id="ä¸widedeepåŒºåˆ«">ä¸wide&amp;deepåŒºåˆ«</h4>
<p><strong>DeepFMï¼šåœ¨Wide&amp;Deepçš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›ï¼Œ</strong></p>
<ol type="1">
<li><p><strong>æŠŠwideæ¨¡å‹éƒ¨åˆ†çš„LRæ›¿æ¢ä¸ºFM</strong>ï¼Œå€ŸåŠ©FMçš„æ˜¾ç¤ºäº¤å‰å¸®åŠ©DNNæ›´å¥½çš„å®ŒæˆEmbeddingã€‚ä¸éœ€è¦é¢„è®­ç»ƒFMå¾—åˆ°éšå‘é‡ï¼Œä¸éœ€è¦äººå·¥ç‰¹å¾å·¥ç¨‹ï¼Œèƒ½åŒæ—¶å­¦ä¹ ä½é˜¶å’Œé«˜é˜¶çš„ç»„åˆç‰¹å¾ï¼› ä½¿ç”¨FMå–ä»£Wideéƒ¨åˆ†çš„LRï¼Œè¿™æ ·<strong>å¯ä»¥é¿å…äººå·¥æ„é€ å¤æ‚çš„ç‰¹å¾å·¥ç¨‹ã€‚</strong></p></li>
<li><p>FMæ¨¡å—å’ŒDeepæ¨¡å—<strong>å…±äº«Feature Embeddingéƒ¨åˆ†</strong>ï¼Œå¯ä»¥<strong>æ›´å¿«çš„è®­ç»ƒï¼Œä»¥åŠæ›´ç²¾ç¡®çš„è®­ç»ƒå­¦ä¹ </strong></p></li>
</ol>
<blockquote>
<p>Wide&amp;Deepï¼šåŒæ—¶å­¦ä¹ ä½é˜¶å’Œé«˜é˜¶ç»„åˆç‰¹å¾ï¼Œå®ƒæ··åˆäº†ä¸€ä¸ªçº¿æ€§æ¨¡å‹ï¼ˆWide partï¼‰å’ŒDeepæ¨¡å‹(Deep part)ã€‚è¿™ä¸¤éƒ¨åˆ†æ¨¡å‹éœ€è¦ä¸åŒçš„è¾“å…¥ï¼Œè€ŒWide partéƒ¨åˆ†çš„è¾“å…¥ï¼Œä¾æ—§ä¾èµ–äººå·¥ç‰¹å¾å·¥ç¨‹ã€‚</p>
</blockquote>
<h3 id="widedeep">wide&amp;deep</h3>
<h4 id="ä¸åŒè¾“å…¥">ä¸åŒè¾“å…¥</h4>
<p>è¿™æ˜¯google paly å•†åº—çš„æ¨èåº”ç”¨ï¼Œwideæ¨¡å‹å’Œdeepæ¨¡å‹æ¥å—äº†ä¸åŒçš„ç‰¹å¾ã€‚ deepæ¨¡å‹ç›´æ¥<strong>æ¥æ”¶è¿ç»­ç‰¹å¾å’Œembeddingåçš„ç¦»æ•£ç‰¹å¾ã€‚</strong>å…¶è¾“å‡ºçš„å³ <img src="/img/in-post/20_07/math-0044321." alt="a{l}=W{l}a{l-1}+b{l}" /> wideæ¨¡å‹<strong>åªæ¥å—äº†éƒ¨åˆ†ç¦»æ•£ç‰¹å¾</strong>ï¼šuser installed appå³ç”¨æˆ·å®‰è£…çš„appï¼Œimpression appå³ç”¨æˆ·çœ‹åˆ°çš„è¢«å±•ç¤ºçš„app(çœ‹åˆ°äº†ä½†æ²¡ä¸‹è½½)ï¼Œä»¥åŠè¿™ä¸¤éƒ¨åˆ†<strong>ç‰¹å¾çš„äº¤å‰</strong>ã€‚å…¶è¾“å‡ºå³ <img src="/img/in-post/20_07/math-20210827140521671" alt="[x,(/img/in-post/20_07/math-20210827140521671)]" />å…¶ä¸­</p>
<p><img src="/img/in-post/20_07/math-20210827140521704" alt="(/img/in-post/20_07/math-20210827140521704)" /> æ˜¯äº¤å‰ç‰¹å¾ã€‚</p>
<h4 id="wideä¸deepåˆ†åˆ«ä»£è¡¨äº†ä»€ä¹ˆ">wideä¸deepåˆ†åˆ«ä»£è¡¨äº†ä»€ä¹ˆï¼Ÿ</h4>
<p>wideæ˜¯ç®€å•çš„çº¿æ€§æ¨¡å‹ï¼Œä»–ä¼šè®°ä½è®­ç»ƒæ•°æ®ä¸­<strong>å·²ç»å‡ºç°</strong>çš„æ¨¡å¼ï¼Œå¹¶èµ‹äºˆæƒé‡ã€‚è¿™ä»£è¡¨äº†<strong>è®°å¿†</strong> deepæ˜¯æ·±åº¦çš„å¤æ‚æ¨¡å‹ï¼Œä¼šåœ¨ä¸€å±‚å±‚çš„ç½‘ç»œä¸­è®¡ç®—å‡ºè®­ç»ƒæ•°æ®ä¸­<strong>æœªå‡ºç°</strong>çš„æ¨¡å¼çš„æƒé‡ã€‚è¿™ä»£è¡¨äº†<strong>æ³›åŒ–</strong> è¿™é‡Œçš„æ¨¡å¼ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºç‰¹å¾ç»„åˆã€‚</p>
<h3 id="word2vecä»‹ç»">âœ… Word2vecä»‹ç»</h3>
<ul>
<li><p>google 2013å¹´æå‡ºçš„ç»å…¸embeddingæ–¹æ³•,<strong>ç”Ÿæˆå¯¹è¯çš„å‘é‡è¡¨è¾¾</strong>ã€‚</p>
<blockquote>
<p>ç”¨onehotè¡¨ç¤ºï¼Œå®é™…è¯è¡¨å¾ˆå¤§ç»´åº¦å¾ˆé«˜ï¼Œæ‰€ä»¥éœ€è¦é€‚å½“çš„é™ç»´æ–¹å¼å°†å‘é‡ç¨ å¯†åŒ–ã€‚Word2vec åªå…³å¿ƒæ¨¡å‹è®­ç»ƒå®Œåçš„å‰¯äº§ç‰©â€”â€”æ¨¡å‹å‚æ•°ï¼ˆè¿™é‡Œç‰¹æŒ‡<strong>ç¥ç»ç½‘ç»œçš„æƒé‡ï¼ˆè¾“å…¥å‘é‡ï¼‰</strong>ï¼‰ï¼Œå¹¶å°†è¿™äº›å‚æ•°ï¼Œä½œä¸ºè¾“å…¥ x çš„æŸç§å‘é‡åŒ–çš„è¡¨ç¤ºï¼Œè¿™ä¸ªå‘é‡ä¾¿å«åšâ€”â€”è¯å‘é‡ã€‚</p>
</blockquote></li>
<li><p>æœ‰<strong>2ç§</strong>è®­ç»ƒæ¨¡å‹ï¼šSkip-Gramå’ŒCBOWã€‚Skip-gramè®¤ä¸ºæ¯ä¸ªè¯å†³å®šäº†ç›¸é‚»çš„è¯ï¼Œæ‰€ä»¥æ˜¯ç”±ä¸­å¿ƒè¯é¢„æµ‹å‘¨å›´è¯ï¼ŒCBOWè®¤ä¸ºæ¯ä¸ªè¯éƒ½ç”±ç›¸é‚»çš„è¯å†³å®šï¼Œæ‰€ä»¥æ˜¯ç”±å‘¨å›´è¯é¢„æµ‹ä¸­å¿ƒè¯ï¼Œä¸€èˆ¬æ˜¯ç”¨å‘¨å›´è¯çš„æ±‚å’Œå¹³å‡é¢„æµ‹ä¸­å¿ƒè¯ã€‚</p>
<ul>
<li><strong>ä»£ä»·å‡½æ•°</strong>å°±æ˜¯å¯ä»¥æœ€å°åŒ–è¿™ä¸¤ä¸ªçŸ©é˜µçš„äº¤å‰ç†µã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>éšå±‚ç¥ç»å…ƒæ˜¯æ²¡æœ‰æ¿€æ´»å‡½æ•°çš„</strong>ï¼Œæˆ–è€…è¯´é‡‡ç”¨äº†è¾“å…¥å³è¾“å‡ºçš„<strong>æ’ç­‰å‡½æ•°</strong>ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œè€Œ<strong>è¾“å‡ºå±‚ç¥ç»å…ƒé‡‡ç”¨äº† softmax ä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚</strong></li>
</ul>
<blockquote>
<p>è®­ç»ƒæ ·æœ¬ç”Ÿæˆæ–¹å¼ï¼šé€‰å–æ»‘çª—å¤§å°,åœ¨ä¸€ä¸ªå¥å­ä¸­æ»‘åŠ¨ä¸€æ¬¡å³ä¸€æ¡è®­ç»ƒæ ·æœ¬ã€‚</p>
<p>å› ä¸ºè¯æ„ä¸»è¦ç”±ä¸Šä¸‹æ–‡å†³å®šï¼Œæ‰€ä»¥<strong>è”ç³»ä¸Šä¸‹æ–‡</strong>ç¡®å®šå‡ºçš„è¯å‘é‡çš„å«ä¹‰æ›´åŠ å‡†ç¡®ã€‚</p>
</blockquote></li>
<li><p>ğŸš© æœ‰<strong>2ç§</strong>åŠ é€Ÿè®­ç»ƒçš„æ–¹æ³•ï¼šå±‚æ¬¡softmaxå’Œè´Ÿé‡‡æ ·ã€‚</p>
<ul>
<li><p>å±‚æ¬¡softmaxåŸºæœ¬æ€æƒ³æ˜¯:ä½¿ç”¨Huffmanæ ‘çš„ç»“æ„å®ç°ï¼ŒæŠŠsoftmaxè½¬åŒ–ä¸ºå¤šæ¬¡çš„sigmoidï¼Œå¤æ‚åº¦ç”±O(n)å˜ä¸ºO(log(n))ã€‚</p></li>
<li><p>è´Ÿé‡‡æ ·çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šæŠŠå¤šåˆ†ç±»é—®é¢˜è½¬åŒ–ä¸ºäºŒåˆ†ç±»é—®é¢˜ï¼Œæ­£æ ·æœ¬æ˜¯ï¼ˆä¸€ä¸ªä¸­å¿ƒè¯å’Œä¸€ä¸ªå‘¨å›´è¯ï¼‰ï¼Œè´Ÿæ ·æœ¬æ˜¯ï¼ˆä¸€ä¸ªä¸­å¿ƒè¯å’Œä¸€ä¸ªéšæœºé‡‡æ ·çš„è´Ÿæ ·æœ¬ï¼‰</p>
<blockquote>
<p>è´Ÿé‡‡æ ·: <strong>è¯­æ–™åº“è¯å¤ªå¤š</strong>äº†,æ¯æ¬¡è¿­ä»£æ›´æ–°æƒé‡æ—¶,éƒ½éœ€è¦è®¡ç®—å­—å…¸ä¸­æ‰€æœ‰è¯çš„é¢„æµ‹è¯¯å·®ã€‚ è´Ÿé‡‡æ ·<strong>åªéœ€å¯¹é‡‡æ ·å‡ºçš„å‡ ä¸ªè´Ÿæ ·æœ¬(ä¸€èˆ¬å°äº10)è®¡ç®—é¢„æµ‹è¯¯å·®</strong>ã€‚ä¼˜åŒ–ç›®æ ‡é€€åŒ–æˆä¸€ä¸ªè¿‘ä¼¼äºŒåˆ†ç±»é—®é¢˜ã€‚https://zhuanlan.zhihu.com/p/52517050</p>
</blockquote></li>
</ul></li>
<li><p>è¿˜æœ‰<strong>1ç§</strong>ä¼˜åŒ–çš„æŠ€æœ¯æ˜¯ï¼šé‡é‡‡æ ·ã€‚</p>
<ul>
<li>é‡é‡‡æ ·çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šæŠŠé«˜é¢‘è¯æ ¹æ®é¢‘æ¬¡è¿›è¡Œåˆ é™¤ï¼ŒæŠŠä½é¢‘æ¬¡å°½é‡çš„ä¿ç•™ä¸‹ï¼Œè¿™æ ·å°±å¯ä»¥åŠ é€Ÿè®­ç»ƒï¼Œå¹¶ä¸”èƒ½å¤Ÿå¾—åˆ°æ›´å¥½çš„è¯å‘é‡ã€‚</li>
</ul></li>
<li><p><strong>æ¨¡å‹å¤æ‚åº¦ä¸Š,æ¯æ¬¡è®¡ç®—æ‰€éœ€è¦çš„å‚æ•°</strong>ï¼š</p>
<ul>
<li><p>å‡ ä¸ªç»“è®º <img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718161416778_20240315115928ThcmO0.png" alt="image-20210718161416778" style="zoom:50%;" /></p>
<ul>
<li><p><strong>cbowæ¯”skipå¿«10å€</strong></p>
<blockquote>
<p>ä¸»è¦æ˜¯åå‘ä¼ æ’­æ¯”è¾ƒèŠ±è´¹æ—¶é—´ï¼Œcbow<strong>ä¸€å…±é¢„æµ‹V(vocab size)æ¬¡</strong>å°±å¤Ÿäº†ï¼Œå¤æ‚åº¦å¤§æ¦‚æ˜¯O(V)ã€‚skip-gramæ˜¯O(KV)</p>
</blockquote></li>
<li><p>cbowå’Œskipéƒ½æ¯”å‰é¦ˆå’Œå¾ªç¯å¿«</p></li>
<li><p>è´Ÿé‡‡æ ·æ¯”å±‚æ¬¡softmaxæ›´å¿«ï¼ˆ14ã€15æ˜¯ä¸´ç•Œï¼‰</p></li>
</ul></li>
</ul></li>
<li><p><strong>æ¨¡å‹æ•ˆæœä¸Š</strong>ï¼š</p>
<ul>
<li>skip gramçš„è®­ç»ƒæ—¶é—´æ›´é•¿ï¼Œä½†æ˜¯å°¤å…¶å¯¹äºä¸€äº›å‡ºç°é¢‘ç‡ä¸é«˜çš„è¯ï¼Œåœ¨CBOWä¸­çš„å­¦ä¹ æ•ˆæœå°±ä¸å¦‚skipgramã€‚åæ­£mikolovè‡ªå·±è¯´çš„skipå‡†ç¡®ç‡æ¯”CBOWé«˜</li>
</ul></li>
<li><p><strong>ç›®æ ‡å‡½æ•°</strong>: å¸Œæœ›æ‰€æœ‰æ—¶é—´<strong>çª—å£å†…çš„æ ·æœ¬</strong>çš„<strong>æ¡ä»¶æ¦‚ç‡ä¹‹å’Œæœ€å¤§</strong>ã€‚ï¼ˆåŸºäºæå¤§ä¼¼ç„¶ä¼°è®¡ï¼‰ <img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718123102349_20240315115929Wp4xnR.png" alt="image-20210718123102349" style="zoom:50%;" /></p>
<blockquote>
<p>cæ˜¯çª—å£å¤§å°ï¼Œ åˆ©ç”¨æ¢¯åº¦ä¸‹é™æ³•åˆ™ä½¿è´Ÿçš„ç›®æ ‡å‡½æ•°æœ€å°</p>
</blockquote>
<ul>
<li><p><strong>æ¡ä»¶æ¦‚ç‡</strong>çš„å®šä¹‰: <strong>å¤šåˆ†ç±»ç”¨softmaxå‡½æ•°</strong>, åŒæ—¶ç”¨è¯ä¹‹é—´<strong>å†…ç§¯è·ç¦»</strong>è¡¨ç¤ºè¯­ä¹‰çš„æ¥è¿‘ç¨‹åº¦,æ‰€ä»¥å®šä¹‰ä¸º: <img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718143534916_202403151159309qR99I.png" alt="image-20210718143534916" style="zoom:25%;" /></p>
<blockquote>
<p>uwæ˜¯æ‰€æœ‰è¯çš„å‘¨å›´è¯çš„è¯å‘é‡</p>
</blockquote></li>
</ul></li>
<li><p>è¾“å…¥ï¼š ï¼ˆdoc idï¼Œwordsï¼‰ï¼Œå¾—åˆ°word Embedding</p></li>
<li><p>è¾“å…¥ï¼šï¼ˆuser idï¼Œitemidsï¼‰ï¼Œå¾—åˆ°item Embedding</p></li>
</ul>
<h4 id="æœ‰2-ç§è®­ç»ƒæ¨¡å¼-skip-gram">æœ‰2 ç§è®­ç»ƒæ¨¡å¼ â€” <strong>Skip-gram</strong></h4>
<p>ç”¨å½“å‰è¯æ¥é¢„æµ‹ä¸Šä¸‹æ–‡ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/v2-ca81e19caa378cee6d4ba6d867f4fc7c_1440w-0044321_20240315115931uF7sYO.jpg" alt="img" style="zoom:50%;" /></p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718144502995_202403151159330kta7h.png" alt="image-20210718144502995" style="zoom:50%;" /></p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718144602093_20240315115935F1x7LX.png" alt="image-20210718144602093" style="zoom:50%;" /></p>
<blockquote>
<p>å¯ä»¥çœ‹æˆæ˜¯ å•ä¸ªx-&gt;å•ä¸ªy æ¨¡å‹çš„å¹¶è”ï¼Œ<strong>cost function</strong> æ˜¯å•ä¸ª cost function çš„ç´¯åŠ ï¼ˆå–logä¹‹åï¼‰</p>
</blockquote>
<h4 id="æœ‰2-ç§è®­ç»ƒæ¨¡å¼-cbow">æœ‰2 ç§è®­ç»ƒæ¨¡å¼ â€” <strong>CBOW</strong></h4>
<p>é€šè¿‡ä¸Šä¸‹æ–‡æ¥é¢„æµ‹å½“å‰å€¼ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/v2-d1ca2547dfb91bf6a26c60782a26aa02_1440w_202403151159362WmSKc.jpg" alt="img" style="zoom: 15%;" /></p>
<blockquote>
<p>æ›´ Skip-gram çš„æ¨¡å‹å¹¶è”ä¸åŒï¼Œè¿™é‡Œæ˜¯è¾“å…¥å˜æˆäº†å¤šä¸ªå•è¯ï¼Œæ‰€ä»¥è¦å¯¹è¾“å…¥å¤„ç†ä¸‹ï¼ˆä¸€èˆ¬æ˜¯<strong>æ±‚å’Œç„¶åå¹³å‡</strong>ï¼‰ï¼Œè¾“å‡ºçš„ <strong>==cost== function</strong> ä¸å˜</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718144200004_20240315115939TDdZMN.png" alt="image-20210718144200004" style="zoom:50%;" /></p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718144413277_20240315115941WlhFe6.png" alt="image-20210718144413277" style="zoom:25%;" /></p>
<h4 id="å¯¹æ¯”ä¸¤ç§è®­ç»ƒæ–¹å¼">å¯¹æ¯”ä¸¤ç§è®­ç»ƒæ–¹å¼</h4>
<ul>
<li><p><strong>æ¨¡å‹å¤æ‚åº¦ä¸Š,æ¯æ¬¡è®¡ç®—æ‰€éœ€è¦çš„å‚æ•°</strong>ï¼š</p>
<ul>
<li><p>skip-gram</p>
<ul>
<li><p>æ™®é€šskip-gram<strong>å‚æ•°ä¸ªæ•°</strong>ï¼š <span class="math inline"><em>Q</em>â€„=â€„<em>C</em>(<em>D</em>â€…+â€…<em>D</em>â€…*â€…<em>V</em>)</span></p>
<blockquote>
<p>å¯¹äºæ¯ä¸ªä¸­å¿ƒè¯ï¼šä¸­å¿ƒè¯å‘é‡Dï¼ŒWâ€™çš„å‚æ•°ï¼šD<em>Vï¼ŒVæ˜¯è¯ç¼–ç ç»´åº¦ï¼Œå‘¨å›´è¯ä¸ªæ•°C å¯¹äºæ¯ä¸ªä¸­å¿ƒè¯éœ€è¦è®¡ç®—çš„å‚æ•°çš„ä¸ªæ•°ä¸ºï¼šå‘¨å›´è¯ä¸ªæ•°C </em> ï¼ˆä¸­å¿ƒè¯å‘é‡ç»´åº¦D + è¯å‘é‡ç»´åº¦D *è¯ç¼–ç ç»´åº¦Vï¼‰</p>
</blockquote></li>
<li><p>åŸºäºå±‚æ¬¡softmax çš„skip-gram<strong>å‚æ•°ä¸ªæ•°</strong>ï¼š <span class="math inline"><em>Q</em>â€„=â€„<em>C</em>(<em>D</em>â€…+â€…<em>D</em>â€…*â€…<em>l</em><em>o</em><em>g</em><sub>2</sub><em>V</em>)</span></p>
<blockquote>
<p>log2Vè¡¨ç¤ºåŸºäºå±‚æ¬¡softmaxï¼Œå¯ä»¥åªè®¡ç®—log2Væ¬¡sigmoidã€‚</p>
</blockquote></li>
<li><p>åŸºäºè´Ÿé‡‡æ · çš„skip-gram<strong>å‚æ•°ä¸ªæ•°</strong>ï¼š <span class="math inline"><em>Q</em>â€„=â€„<em>C</em>(<em>D</em>â€…+â€…<em>D</em>â€…*â€…(<em>K</em>â€…+â€…1))</span></p>
<blockquote>
<p>ï¼ˆ1ä¸ªæ­£æ ·æœ¬+Kä¸ªè´Ÿæ ·æœ¬ï¼‰*Dç»´è¯å‘é‡</p>
</blockquote></li>
</ul></li>
<li><p>CBOWè®­ç»ƒæ›´å¿«ï¼Œç†è®ºä¸Šè¦å¿«10å€</p>
<ul>
<li>æ™®é€šï¼š <span class="math inline"><em>Q</em>â€„=â€„<em>C</em>â€…*â€…<em>D</em>â€…+â€…<em>D</em>â€…*â€…<em>V</em></span></li>
<li>å±‚æ¬¡softmaxï¼š<span class="math inline"><em>Q</em>â€„=â€„<em>C</em>â€…*â€…<em>D</em>â€…+â€…<em>D</em>â€…*â€…<em>l</em><em>o</em><em>g</em><sub>2</sub><em>V</em></span></li>
<li>è´Ÿé‡‡æ ·ï¼š<span class="math inline"><em>Q</em>â€„=â€„<em>C</em>â€…*â€…<em>D</em>â€…+â€…<em>D</em>â€…*â€…(<em>K</em>â€…+â€…1)</span></li>
</ul></li>
<li><p>å‡ ä¸ªç»“è®º <img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718161416778_20240315115928ThcmO0.png" alt="image-20210718161416778" style="zoom:50%;" /></p>
<ul>
<li>cbowå’Œskipéƒ½æ¯”å‰é¦ˆå’Œå¾ªç¯å¿«</li>
<li>cbowæ¯”skipå¿«10å€</li>
<li>è´Ÿé‡‡æ ·æ¯”å±‚æ¬¡softmaxæ›´å¿«ï¼ˆ14ã€15æ˜¯ä¸´ç•Œï¼‰</li>
</ul></li>
</ul></li>
<li><p><strong>æ¨¡å‹æ•ˆæœä¸Š</strong>ï¼š</p>
<ul>
<li><p>skip gramçš„è®­ç»ƒæ—¶é—´æ›´é•¿ï¼Œä½†æ˜¯å°¤å…¶å¯¹äºä¸€äº›å‡ºç°é¢‘ç‡ä¸é«˜çš„è¯ï¼Œåœ¨CBOWä¸­çš„å­¦ä¹ æ•ˆæœå°±ä¸å¦‚skipgramã€‚åæ­£mikolovè‡ªå·±è¯´çš„skipå‡†ç¡®ç‡æ¯”CBOWé«˜</p>
<blockquote>
<ul>
<li><p>æ€»ç»“æ¥è¯´å°±æ˜¯CBOWæ¨¡å‹ä¸­inputæ˜¯contextï¼ˆå‘¨å›´è¯ï¼‰è€Œoutputæ˜¯ä¸­å¿ƒè¯ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­å…¶å®æ˜¯åœ¨ä»outputçš„losså­¦ä¹ å‘¨å›´è¯çš„ä¿¡æ¯ä¹Ÿå°±æ˜¯embeddingï¼Œä½†æ˜¯åœ¨ä¸­é—´å±‚æ˜¯averageçš„ï¼Œ<strong>ä¸€å…±é¢„æµ‹V(vocab size)æ¬¡</strong>å°±å¤Ÿäº†ï¼Œå¤æ‚åº¦å¤§æ¦‚æ˜¯O(V);ã€‚</p></li>
<li><p>skipgramæ˜¯ç”¨ä¸­å¿ƒè¯é¢„æµ‹å‘¨å›´è¯ï¼Œé¢„æµ‹çš„æ—¶å€™æ˜¯ä¸€å¯¹word pairï¼Œç­‰äºå¯¹æ¯ä¸€ä¸ªä¸­å¿ƒè¯éƒ½æœ‰Kä¸ªè¯ä½œä¸ºoutputï¼Œå¯¹äºä¸€ä¸ªè¯çš„é¢„æµ‹æœ‰Kæ¬¡ï¼Œæ‰€ä»¥èƒ½å¤Ÿ<strong>æ›´æœ‰æ•ˆçš„ä»contextä¸­å­¦ä¹ ä¿¡æ¯</strong>ï¼Œä½†æ˜¯**æ€»å…±é¢„æµ‹K*Væ¬¡**ã€‚æ—¶é—´çš„å¤æ‚åº¦ä¸ºO(KV)</p></li>
<li><p>ğŸš© ä½†æ˜¯åœ¨skip-gramå½“ä¸­ï¼Œæ¯ä¸ªè¯éƒ½è¦æ”¶åˆ°å‘¨å›´çš„è¯çš„å½±å“ï¼Œæ¯ä¸ªè¯åœ¨ä½œä¸ºä¸­å¿ƒè¯çš„æ—¶å€™ï¼Œéƒ½è¦è¿›è¡ŒKæ¬¡çš„é¢„æµ‹ã€è°ƒæ•´ã€‚å› æ­¤ï¼Œ å½“æ•°æ®é‡è¾ƒå°‘ï¼Œæˆ–è€…è¯ä¸ºç”Ÿåƒ»è¯å‡ºç°æ¬¡æ•°è¾ƒå°‘æ—¶ï¼Œ è¿™ç§å¤šæ¬¡çš„è°ƒæ•´ä¼šä½¿å¾—è¯å‘é‡ç›¸å¯¹çš„æ›´åŠ å‡†ç¡®ã€‚å› ä¸ºå°½ç®¡cbowä»å¦å¤–ä¸€ä¸ªè§’åº¦æ¥è¯´ï¼ŒæŸä¸ªè¯ä¹Ÿæ˜¯ä¼šå—åˆ°å¤šæ¬¡å‘¨å›´è¯çš„å½±å“ï¼ˆå¤šæ¬¡å°†å…¶åŒ…å«åœ¨å†…çš„çª—å£ç§»åŠ¨ï¼‰ï¼Œè¿›è¡Œè¯å‘é‡çš„è·³å¸§ï¼Œä½†æ˜¯ä»–çš„<strong>è°ƒæ•´æ˜¯è·Ÿå‘¨å›´çš„è¯ä¸€èµ·è°ƒæ•´çš„ï¼Œgradçš„å€¼ä¼šå¹³å‡åˆ†åˆ°è¯¥è¯ä¸Šï¼Œ ç›¸å½“äºè¯¥ç”Ÿåƒ»è¯æ²¡æœ‰æ”¶åˆ°ä¸“é—¨çš„è®­ç»ƒï¼Œå®ƒåªæ˜¯æ²¾äº†å‘¨å›´è¯çš„å…‰è€Œå·²</strong>ã€‚</p></li>
<li><p>ä»æ›´é€šä¿—çš„è§’åº¦æ¥è¯´ï¼š</p>
<p>åœ¨skip-gramé‡Œé¢ï¼Œæ¯ä¸ªè¯åœ¨ä½œä¸ºä¸­å¿ƒè¯çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯ <strong>1ä¸ªå­¦ç”Ÿ VS Kä¸ªè€å¸ˆ</strong>ï¼ŒKä¸ªè€å¸ˆï¼ˆå‘¨å›´è¯ï¼‰éƒ½ä¼šå¯¹å­¦ç”Ÿï¼ˆä¸­å¿ƒè¯ï¼‰è¿›è¡Œâ€œä¸“ä¸šâ€çš„è®­ç»ƒï¼Œè¿™æ ·å­¦ç”Ÿï¼ˆä¸­å¿ƒè¯ï¼‰çš„â€œèƒ½åŠ›â€ï¼ˆå‘é‡ç»“æœï¼‰ç›¸å¯¹å°±ä¼šæ‰å®ï¼ˆå‡†ç¡®ï¼‰ä¸€äº›ï¼Œä½†æ˜¯è¿™æ ·è‚¯å®šä¼šä½¿ç”¨æ›´é•¿çš„æ—¶é—´ï¼›</p>
<p>cbowæ˜¯ <strong>1ä¸ªè€å¸ˆ VS Kä¸ªå­¦ç”Ÿ</strong>ï¼ŒKä¸ªå­¦ç”Ÿï¼ˆå‘¨å›´è¯ï¼‰éƒ½ä¼šä»è€å¸ˆï¼ˆä¸­å¿ƒè¯ï¼‰é‚£é‡Œå­¦ä¹ çŸ¥è¯†ï¼Œä½†æ˜¯è€å¸ˆï¼ˆä¸­å¿ƒè¯ï¼‰æ˜¯ä¸€è§†åŒä»çš„ï¼Œæ•™ç»™å¤§å®¶çš„ä¸€æ ·çš„çŸ¥è¯†ã€‚è‡³äºä½ å­¦åˆ°äº†å¤šå°‘ï¼Œè¿˜è¦çœ‹ä¸‹ä¸€è½®ï¼ˆå‡å¦‚è¿˜åœ¨çª—å£å†…ï¼‰ï¼Œæˆ–è€…ä»¥åçš„æŸä¸€è½®ï¼Œä½ è¿˜æœ‰æœºä¼šåŠ å…¥è€å¸ˆçš„è¯¾å ‚å½“ä¸­ï¼ˆå†æ¬¡å‡ºç°ä½œä¸ºå‘¨å›´è¯ï¼‰ï¼Œè·Ÿç€å¤§å®¶ä¸€èµ·å­¦ä¹ ï¼Œç„¶åè¿›æ­¥ä¸€ç‚¹ã€‚å› æ­¤ç›¸å¯¹skip-gramï¼Œä½ çš„ä¸šåŠ¡èƒ½åŠ›è‚¯å®šæ²¡æœ‰äººå®¶å¼ºï¼Œä½†æ˜¯å¯¹äºæ•´ä¸ªè®­ç»ƒè¥ï¼ˆè®­ç»ƒè¿‡ç¨‹ï¼‰æ¥è¯´ï¼Œè¿™æ ·è‚¯å®šæ•ˆç‡é«˜ï¼Œé€Ÿåº¦æ›´å¿«ã€‚</p></li>
</ul>
</blockquote></li>
</ul></li>
</ul>
<h4 id="å­˜åœ¨çš„é—®é¢˜">å­˜åœ¨çš„é—®é¢˜</h4>
<p>åœ¨è¿›è¡Œæœ€ä¼˜åŒ–çš„æ±‚è§£è¿‡ç¨‹ä¸­ï¼šä»éšè—å±‚åˆ°è¾“å‡ºçš„Softmaxå±‚çš„<strong>è®¡ç®—é‡å¾ˆå¤§</strong>ï¼Œå› ä¸ºè¦è®¡ç®—æ‰€æœ‰è¯çš„Softmaxæ¦‚ç‡ï¼Œå†å»æ‰¾æ¦‚ç‡æœ€å¤§çš„å€¼ã€‚</p>
<h4 id="ä¼˜åŒ–åŠ é€Ÿæ–¹æ³•-å±‚æ¬¡softmaxhierarchical-softmax">ä¼˜åŒ–ï¼ˆåŠ é€Ÿï¼‰æ–¹æ³• â€” å±‚æ¬¡softmaxï¼ˆhierarchical softmaxï¼‰</h4>
<p>æœ¬è´¨æ˜¯æŠŠ N åˆ†ç±»é—®é¢˜å˜æˆ log(N) æ¬¡äºŒåˆ†ç±»ï¼Œæ‰€ä»¥å¤æ‚åº¦ä¹Ÿä»O(n)å˜æˆäº†</p>
<p>æŠŠsoftmaxè½¬åŒ–ä¸º Vä¸ªsigmoid</p>
<p><strong>æ„å»ºhuffmanæ ‘ï¼ˆå¸¦æƒé‡çš„è·¯å¾„æœ€çŸ­äºŒå‰æ ‘ï¼‰ï¼Œåªéœ€è®¡ç®—å°‘äºlog2ï¼ˆVï¼‰æ¬¡çš„sigmoidï¼Œå¤§å¹…åº¦å‡å°‘è®¡ç®—</strong></p>
<h4 id="ä¼˜åŒ–åŠ é€Ÿæ–¹æ³•-è´Ÿé‡‡æ ·negative-sampling">ä¼˜åŒ–ï¼ˆåŠ é€Ÿï¼‰æ–¹æ³• â€” è´Ÿé‡‡æ ·ï¼ˆnegative samplingï¼‰</h4>
<p>æœ¬è´¨æ˜¯é¢„æµ‹æ€»ä½“ç±»åˆ«çš„ä¸€ä¸ªå­é›†ã€‚å°†å¤šåˆ†ç±»é—®é¢˜è½¬åŒ–ä¸º2åˆ†ç±»é—®é¢˜ã€‚</p>
<p>ä¸åŒäºåŸæœ¬æ¯ä¸ªè®­ç»ƒæ ·æœ¬æ›´æ–°æ‰€æœ‰çš„æƒé‡ï¼Œè´Ÿé‡‡æ ·æ¯æ¬¡è®©ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ä»…ä»…æ›´æ–°ä¸€å°éƒ¨åˆ†çš„æƒé‡ï¼Œè¿™æ ·å°±ä¼š<strong>é™ä½æ¢¯åº¦ä¸‹é™è¿‡ç¨‹ä¸­çš„è®¡ç®—é‡</strong>ã€‚ å½“ä½¿ç”¨è´Ÿé‡‡æ ·æ—¶ï¼Œæˆ‘ä»¬<strong>å°†éšæœºé€‰æ‹©ä¸€å°éƒ¨åˆ†çš„negative wordsï¼ˆæ¯”å¦‚é€‰5ä¸ªnegative wordsï¼‰æ¥æ›´æ–°å¯¹åº”çš„æƒé‡</strong>ã€‚æˆ‘ä»¬ä¹Ÿä¼šå¯¹æˆ‘ä»¬çš„â€œpositiveâ€ wordè¿›è¡Œæƒé‡æ›´æ–°ï¼ˆåœ¨æˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè¿™ä¸ªå•è¯æŒ‡çš„æ˜¯â€quickâ€œï¼‰ã€‚</p>
<p>ä¸€ä¸ªå•è¯è¢«é€‰ä½œnegative sampleçš„<strong>æ¦‚ç‡è·Ÿå®ƒå‡ºç°çš„é¢‘æ¬¡æœ‰å…³ï¼Œå‡ºç°é¢‘æ¬¡è¶Šé«˜çš„å•è¯è¶Šå®¹æ˜“è¢«é€‰ä½œnegative wordsã€‚</strong>æ¯ä¸ªå•è¯è¢«é€‰ä¸ºâ€œnegative wordsâ€çš„æ¦‚ç‡è®¡ç®—å…¬å¼ä¸å…¶å‡ºç°çš„é¢‘æ¬¡æœ‰å…³, ä»£ç ä¸­çš„å…¬å¼å®ç°å¦‚ä¸‹ï¼š</p>
<figure>
<img src="/img/in-post/20_07/equation-20210827140521676" alt="[å…¬å¼]" /><figcaption>[å…¬å¼]</figcaption>
</figure>
<p>æ¯ä¸ªå•è¯è¢«èµ‹äºˆä¸€ä¸ªæƒé‡<span class="math inline"><em>f</em>(<em>w</em><sub><em>i</em></sub>)</span>ï¼Œå®ƒä»£è¡¨ç€å•è¯å‡ºç°çš„é¢‘æ¬¡ã€‚</p>
<blockquote>
<p>å› ä¸ºå¾€å¾€é¢‘æ¬¡é«˜çš„è¯ä¸é‡è¦ï¼Œæ‰€ä»¥è¦ç”¨3/4ï¼Œä½¿é¢‘ç‡å°çš„è¯æ¦‚ç‡å¤§ä¸€ç‚¹</p>
</blockquote>
<h4 id="ä¼˜åŒ–æ–¹æ³•3-é«˜é¢‘è¯é‡é‡‡æ ·">ä¼˜åŒ–æ–¹æ³•3 â€” é«˜é¢‘è¯é‡é‡‡æ ·</h4>
<p>æ–‡æ¡£ä¸­çš„è¯ï¼Œå‡ºç°é¢‘ç‡é«˜çš„ä¿¡æ¯å°ï¼Œå‡ºç°é¢‘ç‡å°çš„ ä¿¡æ¯å¤šï¼Œæ¯”å¦‚æ–¹æ³•<strong>tfidfã€BM25</strong>å°±æ˜¯æ ¹æ®è¿™ä¸ªæ€æƒ³å®ç°çš„ï¼Œåœ¨è¯è¢‹æ¨¡å‹é‡Œæœ‰æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚</p>
<p>åŸå› ï¼š1. å¸Œæœ›æ›´å¤šåœ°è®­ç»ƒé‡è¦çš„è¯å¯¹ï¼ˆé¢‘ç‡ä½ï¼‰ 2. é«˜é¢‘è¯å¾ˆå¿«å°±è®­ç»ƒå¥½äº†ï¼Œä½é¢‘æ¬¡éœ€è®­ç»ƒå¾ˆå¤šè½®æ¬¡</p>
<p>æ–¹æ³•ï¼šè®­ç»ƒé›†ä¸­çš„è¯wä¼šä»¥ <span class="math inline"><em>P</em>(<em>w</em><sub><em>i</em></sub>)</span>çš„æ¦‚ç‡è¢«åˆ é™¤ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718153314845_20240315115942e86Ah0.png" alt="image-20210718153314845" style="zoom:25%;" /></p>
<blockquote>
<p>è¯é¢‘è¶Šå¤§ï¼ŒPè¶Šå¤§ï¼›å¦‚æœè¯é¢‘få°äºtï¼ˆå¦‚10**-5ï¼‰ï¼Œåˆ™ä¸ä¼šè¢«åˆ é™¤</p>
</blockquote>
<p>ä¼˜ç‚¹ï¼šåŠ é€Ÿè®­ç»ƒï¼Œèƒ½å¤Ÿå¾—åˆ°æ›´å¥½çš„è¯å‘é‡ã€‚</p>
<h4 id="ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</h4>
<p>ä¼˜ç‚¹ï¼š</p>
<ol type="1">
<li>ç”±äº Word2vec ä¼šè€ƒè™‘ä¸Šä¸‹æ–‡ï¼Œè·Ÿä¹‹å‰çš„ Embedding æ–¹æ³•ç›¸æ¯”ï¼Œæ•ˆæœè¦æ›´å¥½ï¼ˆä½†ä¸å¦‚ 18 å¹´ä¹‹åçš„æ–¹æ³•ï¼‰</li>
<li>æ¯”ä¹‹å‰çš„ Embeddingæ–¹ æ³•ç»´åº¦æ›´å°‘ï¼Œæ‰€ä»¥é€Ÿåº¦æ›´å¿«</li>
<li>é€šç”¨æ€§å¾ˆå¼ºï¼Œå¯ä»¥ç”¨åœ¨å„ç§ NLP ä»»åŠ¡ä¸­</li>
</ol>
<p>ç¼ºç‚¹ï¼š</p>
<ol type="1">
<li>ç”±äºè¯å’Œå‘é‡æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œæ‰€ä»¥å¤šä¹‰è¯çš„é—®é¢˜æ— æ³•è§£å†³ã€‚</li>
<li>Word2vec æ˜¯ä¸€ç§é™æ€çš„æ–¹å¼ï¼Œè™½ç„¶é€šç”¨æ€§å¼ºï¼Œä½†æ˜¯æ— æ³•é’ˆå¯¹ç‰¹å®šä»»åŠ¡åšåŠ¨æ€ä¼˜åŒ–</li>
</ol>
<h3 id="word2vecé¢è¯•é—®é¢˜">Word2vecé¢è¯•é—®é¢˜</h3>
<h4 id="ä¸ºä»€ä¹ˆä¸ä½¿ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°">ä¸ºä»€ä¹ˆä¸ä½¿ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Ÿ</h4>
<p>è¾“å‡ºå±‚æ¥softmax å‡½æ•°ï¼Œéšè—å±‚ä¸€èˆ¬çº¿æ€§æ¿€æ´»å‡½æ•°ã€‚</p>
<ol type="1">
<li><p>æœ€å¤§å¥½å¤„æ˜¯è®­ç»ƒå¿«ï¼Œ</p></li>
<li><p>æ›´é‡è¦çš„åŸå› æ˜¯è¾“å…¥è¯å’Œé¢„æµ‹è¯ï¼Œåœ¨è¯­æ–™åº“ä¸­å¾€å¾€æœ‰<strong>å…±ç°å…³ç³»</strong>ï¼ˆç›¸é‚»å…±åŒå‡ºç°ï¼‰çš„ï¼Œç”¨çº¿æ€§æ¿€æ´»å‡½æ•°ä¸»è¦ä¿ç•™è¿™å±‚å…±ç°å…³ç³»ï¼ˆè®­ç»ƒå‡ºæ¥çš„è¯å¤§é‡<strong>çº¿æ€§ç›¸å…³ğŸš©</strong>ï¼‰ã€‚</p></li>
</ol>
<h3 id="item2vecä»‹ç»">item2vecä»‹ç»</h3>
<ul>
<li>word2vecåœ¨æ¨èç³»ç»Ÿä¸­çš„æ¨å¹¿,å¾®è½¯äº2016å¹´æå‡ºã€‚</li>
<li><strong>ç”¨æˆ·embeddingå‘é‡</strong>ç”±å†å²è¡Œä¸ºä¸­çš„<strong>ç‰©å“embeddingå¹³å‡æˆ–èšç±»å¾—åˆ°</strong>,è®¡ç®—ç”¨æˆ·å‘é‡ä¸ç‰©å“å‘é‡ç›¸ä¼¼æ€§ç›´æ¥åœ¨æ¨èç³»ç»Ÿ<strong>å¬å›å±‚</strong>å¿«é€Ÿå¾—åˆ°å€™é€‰é›†å’Œ,æˆ–åœ¨æ’åºå±‚ç›´æ¥ç”¨äºæœ€ç»ˆæ¨èåˆ—è¡¨æ’åºã€‚</li>
<li>ç‰©å“åºåˆ—çš„äº§ç”Ÿ: ç”±ç‰¹ç‚¹ç”¨æˆ·çš„æµè§ˆã€è´­ä¹°ç­‰è¡Œä¸ºäº§ç”Ÿçš„å†å²è¡Œä¸ºè®°å½•åºåˆ—ã€‚</li>
<li>å’Œword2vecå”¯ä¸€ä¸åŒåœ¨äº, æ‘’å¼ƒæ‰æ—¶é—´çª—å£æ¦‚å¿µ, <strong>è®¤ä¸ºåºåˆ—ä¸­ä»»æ„ä¸¤ä¸ªç‰©å“éƒ½ç›¸å…³</strong>ã€‚æ‰€ä»¥<strong>ç›®æ ‡å‡½æ•°</strong>ä¸º<u>ä¸¤ä¸¤ç‰©å“å¯¹æ•°æ¦‚ç‡ä¹‹å’Œ: </u> <img src="https://cdn.jsdelivr.net/gh/AIGoBig/PicRepo@master/2024/03/image-20210718163933488_20240315115943fwlS7V.png" alt="image-20210718163933488" style="zoom: 25%;" /></li>
<li><strong>å¹¿ä¹‰çš„item2vec: åŒå¡”æ¨¡å‹, ç‰©å“ä¾§+ç”¨æˆ·ä¾§</strong>, æœ¬è´¨æ˜¯æ¥å—ç‰©å“å’Œç”¨æˆ·ç›¸å…³çš„ç‰¹å¾å‘é‡, ç»è¿‡å¤šå±‚ç¥ç»ç½‘ç»œç»“æ„ç”Ÿæˆå¤šç»´çš„ç¨ å¯†å‘é‡,å®åˆ™ä¸ºembeddingå‘é‡ã€‚åªä¸è¿‡æ¨¡å‹ä¸æ˜¯ç®€å•çš„w2v,è€Œæ˜¯æ›´å¤æ‚çµæ´»çš„æ¨¡å‹,è¾“å…¥ç‰¹å¾ä¸æ­¢çš„one-hot,<strong>å¯ä»¥åŒ…å«æ›´å¤šçš„ç‰¹å¾å‘é‡ã€‚</strong></li>
<li>å±€é™æ€§:åªèƒ½åˆ©ç”¨<strong>åºåˆ—åŒ–æ•°æ®</strong>,å¤„ç†ç½‘ç»œåŒ–æ•°æ®ä¸å®¹æ˜“ã€‚éœ€è¦Graph Embedding</li>
<li>æ•°æ®ï¼š
<ul>
<li>è¾“å…¥ï¼š ï¼ˆdoc idï¼Œwordsï¼‰ï¼Œå¾—åˆ°word Embedding</li>
<li>è¾“å…¥ï¼šï¼ˆuser idï¼Œitemidsï¼‰ï¼Œå¾—åˆ°item Embedding</li>
<li>ä½¿ç”¨æ ‡é¢˜/å†…å®¹çš„åˆ†è¯Embeddingåšæ¨èï¼Œå±äºå†…å®¹ç›¸ä¼¼æ€§æ¨è</li>
<li>ä½¿ç”¨è¡Œä¸ºåˆ—è¡¨ä½œæ¨èï¼Œå±äºè¡Œä¸ºç›¸å…³æ€§æ¨èï¼Œæ•ˆæœæ¯”å†…å®¹ç›¸ä¼¼æ¨èå¥½</li>
<li>æŠŠword embedding è¿›è¡ŒåŠ å’Œã€å¹³å‡ï¼Œå¾—åˆ°document embedding</li>
<li>æŠŠitem embedding è¿›è¡ŒåŠ å’Œã€å¹³å‡ï¼Œå¾—åˆ°user embedding</li>
</ul></li>
</ul>
<h3 id="è¯„ä»·æŒ‡æ ‡">è¯„ä»·æŒ‡æ ‡</h3>
<h4 id="auc">AUC</h4>
<h2 id="fmç®—æ³•">FMç®—æ³•</h2>
<p><a href="https://zhuanlan.zhihu.com/p/37963267">FMç®—æ³•è§£æ</a></p>
<h3 id="åº”ç”¨åœºæ™¯"><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</h3>
<p>ç‚¹å‡»é¢„ä¼°ã€‚</p>
<p>å‡†ç¡®çš„ä¼°è®¡ ctrã€cvr å¯¹äºæé«˜æµé‡çš„ä»·å€¼ï¼Œå¢åŠ å¹¿å‘Šæ”¶å…¥æœ‰é‡è¦çš„æŒ‡å¯¼ä½œç”¨ã€‚<strong>ä¸šç•Œå¸¸ç”¨çš„æ–¹æ³•</strong>æœ‰äººå·¥ç‰¹å¾å·¥ç¨‹ + LRï¼ˆLogistic Regressionï¼‰ã€GBDTï¼ˆGradient Boosting Decision Treeï¼‰ + LR[<a href="https://link.zhihu.com/?target=http%3A//blog.csdn.net/lilyth_lilyth/article/details/48032119">1]</a>[<a href="https://link.zhihu.com/?target=http%3A//www.cnblogs.com/Matrix_Yao/p/4773221.html">2]</a>[<a href="https://link.zhihu.com/?target=http%3A//blog.csdn.net/lilyth_lilyth/article/details/48032119">3]</a>ã€FMï¼ˆFactorization Machineï¼‰[<a href="https://link.zhihu.com/?target=http%3A//www.cnblogs.com/Matrix_Yao/p/4773221.html">2]</a>[<a href="https://link.zhihu.com/?target=http%3A//www.algo.uni-konstanz.de/members/rendle/pdf/Rendle2010FM.pdf">7]</a>å’ŒFFMï¼ˆField-aware Factorization Machineï¼‰[<a href="https://link.zhihu.com/?target=http%3A//www.csie.ntu.edu.tw/~r01922136/slides/ffm.pdf">9]</a>æ¨¡å‹ã€‚åœ¨è¿™äº›æ¨¡å‹ä¸­ï¼Œ<strong>FMå’ŒFFMè¿‘å¹´æ¥è¡¨ç°çªå‡º</strong>ï¼Œåˆ†åˆ«åœ¨ç”±Criteoå’ŒAvazuä¸¾åŠçš„CTRé¢„æµ‹ç«èµ›ä¸­å¤ºå¾—å† å†›[<a href="https://link.zhihu.com/?target=https%3A//www.kaggle.com/c/criteo-display-ad-challenge">4]</a>[<a href="https://link.zhihu.com/?target=https%3A//www.kaggle.com/c/avazu-ctr-prediction">5]</a>ã€‚</p>
<p>åœ¨è¿›è¡ŒCTRé¢„ä¼°æ—¶ï¼Œé™¤äº†å•ç‰¹å¾å¤–ï¼Œå¾€å¾€è¦å¯¹ç‰¹å¾è¿›è¡Œç»„åˆã€‚<strong>å¯¹äºç‰¹å¾ç»„åˆæ¥è¯´</strong>ï¼Œä¸šç•Œç°åœ¨é€šç”¨çš„åšæ³•ä¸»è¦æœ‰ä¸¤å¤§ç±»<strong>ï¼šFMç³»åˆ—</strong>ä¸<strong>Treeç³»åˆ—</strong>ã€‚</p>
<h3 id="ç›®çš„"><strong>ç›®çš„</strong>ï¼š</h3>
<p>æ—¨åœ¨è§£å†³å¤§è§„æ¨¡<strong>ç¨€ç–æ•°æ®</strong>ä¸‹çš„ç‰¹å¾ç»„åˆé—®é¢˜çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚</p>
<h3 id="ä¼˜åŠ¿"><strong>ä¼˜åŠ¿</strong>ï¼š</h3>
<ul>
<li>é«˜åº¦ç¨€ç–æ•°æ®åœºæ™¯ï¼›</li>
<li>å…·æœ‰çº¿æ€§çš„è®¡ç®—å¤æ‚åº¦ã€‚</li>
</ul>
<h2 id="deepfm">DeepFM</h2>
<h3 id="æ–°é—»æ¨èç³»ç»Ÿé¡¹ç›®-word2vecç”Ÿæˆç ”æŠ¥embeddingæ€ä¹ˆç”¨çš„-ä»€ä¹ˆåŸç†">æ–°é—»æ¨èç³»ç»Ÿé¡¹ç›® word2vecç”Ÿæˆç ”æŠ¥Embeddingï¼Œæ€ä¹ˆç”¨çš„ ä»€ä¹ˆåŸç†</h3>
<h3 id="deepfmé‡Œçš„æŸå¤±å‡½æ•°çš„æ”¹è¿›çœ‹è®ºæ–‡"><strong>deepfmé‡Œçš„æŸå¤±å‡½æ•°çš„æ”¹è¿›â€”çœ‹è®ºæ–‡</strong></h3>
<h3 id="dnn-ä¸-deepfm-ä¹‹é—´çš„åŒºåˆ«">DNN ä¸ DeepFM ä¹‹é—´çš„åŒºåˆ«</h3>
<p>DNN æ˜¯ DeepFM ä¸­çš„ä¸€ä¸ªéƒ¨åˆ†ï¼ŒDeepFM å¤šä¸€æ¬¡ç‰¹å¾ï¼Œå¤šä¸€ä¸ª FM å±‚çš„äºŒæ¬¡äº¤å‰ç‰¹å¾</p>
<h3 id="ä½ åœ¨ä½¿ç”¨-deepfm-çš„æ—¶å€™æ˜¯å¦‚ä½•å¤„ç†æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆé—®é¢˜çš„">2.ä½ åœ¨ä½¿ç”¨ deepFM çš„æ—¶å€™æ˜¯å¦‚ä½•å¤„ç†æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆé—®é¢˜çš„</h3>
<p>æ¬ æ‹Ÿåˆ:å¢åŠ deepéƒ¨åˆ†çš„å±‚æ•°ï¼Œå¢åŠ epochçš„è½®æ•°ï¼Œå¢åŠ learningrateï¼Œå‡å°‘æ­£åˆ™ åŒ–åŠ›åº¦</p>
<p>è¿‡æ‹Ÿåˆ:åœ¨deepå±‚ç›´æ¥å¢åŠ dropoutçš„ç‡ï¼Œå‡å°‘epochè½®æ•°ï¼Œå¢åŠ æ›´å¤šçš„æ•°æ®ï¼Œå¢ åŠ æ­£åˆ™åŒ–åŠ›åº¦ï¼Œshuffle æ•°æ®</p>
