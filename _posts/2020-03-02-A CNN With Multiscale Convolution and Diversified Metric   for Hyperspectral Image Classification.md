---
layout: post
title: "A CNN With Multiscale Convolution and Diversified Metric for Hyperspectral Image Classification"
subtitle: 'From Vim to Spacemacs'
author: "Sun"
header-style: text
tags:
  - Paper
  - DPP
  - DML
  - CNN
---

â€¢IEEE Transactions on Geoscience and Remote Sensing, 2019, 57(6): 3599-3618.

â€¢æå‡ºäº†ä¸€ç§DPP-DML-MS-CNNæ–¹æ³•, åŒæ—¶åˆ©ç”¨äº†**åŸºäºDPPçš„ä¿ƒè¿›å¤šæ ·æ€§çš„æ·±åº¦åº¦é‡**å’Œ**å¤šå°ºåº¦ç‰¹å¾**ï¼Œç”¨äºé«˜å…‰è°±å›¾åƒåˆ†ç±»ã€‚
![image-20200302104353207](/img/in-post/20_03/image-20200302104353207.png)

## index

multi-scale feature â†’ MS-CNN

determinantal point process (DPP) 

deep metric learning(DML) 

# MS-CNN

## æå‡ºåŸå› 

ç”±äºè®­ç»ƒæ ·æœ¬æ•°é‡æœ‰é™ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå…·æœ‰è¾ƒå¤§ç±»å†…æ–¹å·®å’Œä½ç±»é—´æ–¹å·®çš„å›¾åƒï¼Œå­¦ä¹ çš„æ·±åº¦æ¨¡å‹å¯èƒ½ä¸æ˜¯æœ€ä¼˜çš„ã€‚

## åˆ›æ–°ç‚¹

åœ¨æœ¬æ–‡ä¸­ï¼Œæå‡ºäº†å…·æœ‰å¤šå°ºåº¦å·ç§¯ï¼ˆMS-CNNï¼‰çš„æ–°å‹å·ç§¯ç¥ç»ç½‘ç»œï¼Œé€šè¿‡ä»é«˜å…‰è°±å›¾åƒä¸­æå–æ·±å±‚å¤šå°ºåº¦ç‰¹å¾æ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚

è®¾è®¡äº†ä¸‰ç§ç±»å‹çš„MS-CNNç”¨äºé«˜å…‰è°±å›¾åƒåˆ†ç±»ã€‚é€šè¿‡å°†å¤šå°ºåº¦æ»¤æ³¢å™¨ç»„åˆå¹¶åˆ°CNNä¸­ä»¥ä»å›¾åƒä¸­æå–å¤šå°ºåº¦ç‰¹å¾çš„CNNç»“æ„ã€‚ 

![image-20200302112453920](/img/in-post/20_03/image-20200302112453920.png)

![image-20200302112510439](/img/in-post/20_03/image-20200302112510439.png)

![image-20200302112517053](/img/in-post/20_03/image-20200302112517053.png)

# **Deep metric learning** (DML)

ä½†æ˜¯ï¼Œåœ¨**åº¦é‡è½¬æ¢**ä¸­ç”¨ä¸€èˆ¬çš„ç»“æ„æŸå¤±æ¥å­¦ä¹ åº¦é‡å‚æ•°å› å­é€šå¸¸ä¼šä½¿å­¦ä¹ åˆ°çš„å› å­ä¹‹é—´å…·æœ‰**ç›¸ä¼¼æ€§**ã€‚è¿™ç§ç›¸ä¼¼æ€§å°†è´Ÿé¢å½±å“æ·±åº¦åº¦é‡æ¨¡å‹å¯¹é«˜å…‰è°±å›¾åƒçš„è¡¨ç¤ºèƒ½åŠ›ã€‚

â€¢HSI æ²¡æœ‰è¶³å¤Ÿæ ‡è®°çš„æ ·æœ¬

â€¢ä¸åŒç±»åˆ«æ ·æœ¬è¡¨ç°ç›¸ä¼¼ç‰¹å¾

å› æ­¤å­¦ä¹ åˆ°çš„ç”¨äºè¡¨ç¤ºHSIçš„metric factorsæ˜æ˜¾å†—ä½™,ä¸åŒmetric factorsä»å›¾åƒæå–ç›¸ä¼¼ç‰¹å¾, å¯¼è‡´åˆ†ç±»æ€§èƒ½é™ä½

![image-20200302112800844](/img/in-post/20_03/image-20200302112800844.png)

# DPP prior

![image-20200302113857348](/img/in-post/20_03/image-20200302113857348.png)

>  Î¸åœ¨æ­¤å¤„æ˜¯è¿ç»­ç©ºé—´, Bæ˜¯Î¸çš„ä»»æ„å­é›†
>
>  ğ‘(BâŠ‚Î¸) è¡¨ç¤ºBä¸­å…ƒç´ é‡‡æ ·ä¸­è¢«å‘½ä¸­çš„æ¦‚ç‡, å³Bçš„DPPå…ˆéªŒ
>
>  Î»å¯ä»¥è§†ä¸ºæƒè¡¡å‚æ•°ï¼Œè¯¥å‚æ•°è¡¡é‡å¤šæ ·åŒ–æƒ©ç½šçš„æƒé‡ã€‚ äºŒç»´å¹³é¢éšæœºé‡‡æ ·

â€¢çŸ©é˜µK è¢«ç§°ä½œ DPP kernelï¼Œæ˜¯ä¸€ä¸ª ğ‘Ã—ğ‘çš„å®å¯¹ç§°æ–¹é˜µã€‚

>  K~B~æ˜¯æ ¹æ®Bä¸­çš„å…ƒç´ ä» ğ¾ä¸­æŒ‰è¡ŒæŒ‰åˆ—ç´¢å¼•å¾—åˆ°çš„æ–¹é˜µï¼Œä¹Ÿå³K~B~æ˜¯ ğ¾çš„ä¸»å­å¼
>
>  det(K~B~) æ˜¯çŸ©é˜µK~B~çš„è¡Œåˆ—å¼å€¼ã€‚
>
> ğ¾ çš„å…ƒç´  ğ¾ğ‘–ğ‘— å¯ä»¥çœ‹åšé›†åˆÎ¸ä¸­ç¬¬ğ‘–,ğ‘—ä¸ªå…ƒç´ ä¹‹é—´çš„**ç›¸ä¼¼åº¦** 
>
> ğ¾ğ‘–ğ‘– è¶Šå¤§çš„æ ·æœ¬ï¼Œè¢«é‡‡æ ·å‡ºæ¥çš„æ¦‚ç‡è¶Šå¤§
>
> ğ¾ğ‘–ğ‘—è¶Šå¤§çš„çš„ä¸¤ä¸ªæ ·æœ¬ {ğ‘–,ğ‘—} è¶Šç›¸ä¼¼ï¼Œ
>
>  è¢«åŒæ—¶é‡‡æ ·å‡ºæ¥çš„æ¦‚ç‡è¶Šä½

äºŒç»´å¹³é¢éšæœºé‡‡æ ·:

![image-20200302120120989](/img/in-post/20_03/image-20200302120120989.png)

é‡‡æ ·æ¦‚ç‡è®¡ç®—:																					

![image-20200302120126678](/img/in-post/20_03/image-20200302120126678.png)

# Determinantal point process(DPP) based DML

â€¢é€šè¿‡**å¤šæ ·åŒ–ï¼ˆdiversificationï¼‰**ï¼Œä¸åŒçš„å› å­(factors)å€¾å‘äºå¯¹ä¸åŒçš„ç‰¹å¾(features)åšå‡ºååº”, å¯ä»¥æ ¹æ®å›¾åƒå»ºæ¨¡æ›´å¤šçš„ç‰¹å¾(features)ã€‚å› æ­¤éœ€è¦åŠ å…¥ä¿ƒè¿›å¤šæ ·æ€§çš„å…ˆéªŒ(diversity-promoting priors)ã€‚

â€¢ä¸ºäº†ä½¿å­¦ä¹ åˆ°çš„**åº¦é‡å‚æ•°å› å­å¤šæ ·åŒ–**ï¼Œå¹¶è¿›ä¸€æ­¥æé«˜æ·±åº¦åº¦é‡çš„è¡¨ç¤ºèƒ½åŠ›ï¼Œæå‡ºäº†ä¸€ç§**åŸºäºDPPçš„ç»“æ„æŸå¤±**, å¯¹å­¦ä¹ åˆ°çš„åº¦é‡å‚æ•°å› å­æ–½åŠ ç¡®å®šæ€§ç‚¹è¿‡ç¨‹ï¼ˆDPPï¼‰å…ˆéªŒï¼Œä»¥**é¼“åŠ±å­¦ä¹ åˆ°çš„åº¦é‡å› å­ç›¸äº’æ’æ–¥**ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œä½¿ç”¨è¿™ç§**å…·æœ‰ç‰¹æ®Šç»“æ„æŸå¤±çš„æ·±åº¦åº¦é‡å­¦ä¹ æ–¹æ³•**ï¼Œä»¥**è”åˆè®­ç»ƒ**æ‰€æå‡ºçš„æ¨¡å‹ã€‚

â€¢**ç»“æ„æŸå¤±**Lç”¨äº**æœ€å°åŒ–æ‰€æœ‰æ­£å¯¹ä¹‹é—´çš„è·ç¦»,å¹¶æƒ©ç½šäº†ç›¸åº”çš„è´Ÿå¯¹**

![image-20200302112957361](/img/in-post/20_03/image-20200302112957361.png)

â€¢ç‰¹å¾è·ç¦»å‡½æ•°:

![image-20200302113240820](/img/in-post/20_03/image-20200302113240820.png)

â€¢è´Ÿå¯¹æƒ©ç½šå‡½æ•°:

![image-20200302113246170](/img/in-post/20_03/image-20200302113246170.png)

> å…¶ä¸­, mæ˜¯ä¸€ä¸ªæ­£å€¼ï¼Œè¡¨ç¤ºå¯¹è´Ÿå¯¹è·ç¦»çš„æƒ©ç½šè¾¹ç•Œã€‚
>  xi, xj: åŒä¸€ç±»åˆ«çš„æ ·æœ¬å¯¹(positive pairs) xi, xkï¼šä¸åŒç±»åˆ«æ ·æœ¬å¯¹(negative pairs)
> å¯ä»¥æ³¨æ„åˆ°ï¼ŒBå¯ä»¥çœ‹æˆæ˜¯çº¿æ€§æ˜ å°„ï¼Œå¯ä»¥è®­ç»ƒæˆMS-CNNä¸­çš„å…¨è¿æ¥å±‚ã€‚

â€¢é€šè¿‡æœ€å¤§åéªŒæ¦‚ç‡(MAP)ä¼°è®¡ï¼š![image-20200302122417727](/img/in-post/20_03/image-20200302122417727.png)

>  å…¶ä¸­Xæ˜¯è®­ç»ƒæ ·æœ¬çš„é›†åˆã€‚

â€¢ç­‰æ•ˆå¯¹æ•°ä¼¼ç„¶æ–¹ç¨‹å¯è¡¨ç¤ºä¸º:

![image-20200302122427819](/img/in-post/20_03/image-20200302122427819.png)

â€¢è½¬åŒ–ä¸ºçº¦æŸä¼˜åŒ–:

![image-20200302122640399](/img/in-post/20_03/image-20200302122640399.png)

â€¢é€šè¿‡é€šè¿‡æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°ï¼Œé‡æ–°åŒ–ä¸ºæ— çº¦æŸä¼˜åŒ–:

![image-20200302122648104](/img/in-post/20_03/image-20200302122648104.png)

â€¢ç”¨äºè®­ç»ƒMS-CNNçš„**åŸºäºDPPçš„ç»“æ„æŸå¤±** :

![image-20200302122652956](/img/in-post/20_03/image-20200302122652956.png)

â€¢é€šè¿‡éšæœºæ¢¯åº¦ä¸‹é™æ–¹æ³•è”åˆè®­ç»ƒMS-CNNå’Œæ·±åº¦åº¦é‡ã€‚è®­ç»ƒè¿‡ç¨‹å¯ä»¥çœ‹ä½œæ˜¯æœ€å°åŒ–åŸºäºDPPçš„ç»“æ„æŸå¤±ã€‚Wè¡¨ç¤ºMS-CNNä¸­çš„å‚æ•°, Bè¡¨ç¤ºåº¦é‡å‚æ•°å› å­ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼°ç®—æ‰€æå‡ºæ¨¡å‹ä¸­çš„å‚æ•°

![image-20200302123010188](/img/in-post/20_03/image-20200302123010188.png)

â€¢åŸºäºDPPçš„ç»“æ„åŒ–æŸå¤±Lç›¸å¯¹äºåº¦é‡å› å­Bçš„æ¢¯åº¦å¯ä»¥è®¡ç®—ä¸º: 

![image-20200302123016706](/img/in-post/20_03/image-20200302123016706.png)

â€¢ä»æµç¨‹å›¾å¯ä»¥çœ‹å‡º, åŸºäºDPPçš„ç»“æ„æŸå¤±çš„å­¦ä¹ æ¨¡å‹ç”¨äºä»é«˜å…‰è°±å›¾åƒä¸­æå–ç‰¹å¾**ï¼Œ**ç„¶åä½¿ç”¨Softmaxåˆ†ç±»å™¨ç”¨äºåˆ†ç±»**ã€‚**

â€¢è¯¥æ¨¡å‹é€šè¿‡ç¡®å®šæ€§ç‚¹è¿‡ç¨‹ï¼ˆDPPï¼‰å…ˆéªŒè€Œéç‹¬ç«‹å…ˆéªŒæ¥ä½¿æ·±åº¦åº¦é‡å¤šæ ·åŒ–, å¼€å‘äº†ä¸€ç§å…·æœ‰**å¤šå°ºåº¦å·ç§¯å’Œå¤šæ ·åŒ–åº¦é‡çš„****CNN**ï¼Œä»¥è·å¾—é«˜å…‰è°±å›¾åƒåˆ†ç±»çš„åˆ¤åˆ«ç‰¹å¾ã€‚

![image-20200302123035175](/img/in-post/20_03/image-20200302123035175.png)

# Result

##Â A.Computational Performance

![image-20200302123208238](/img/in-post/20_03/image-20200302123208238.png)

> For pre-training procedure:
>
>  the training epoch, the base learning rate, the weight decay, and the momentum value 
>
> were set to 20000, 0.0001, 5e-5, and 0.9, respectively.
>
> For fine-tuning procedure: 
>
> the training epoch, the base learning rate, the weight decay, and the momentum value 
>
> were set to 1000, 1e-5, 5e-5, and 0.9, respectively.

## **B. Modelâ€™s Diversity**

![image-20200302123314790](/img/in-post/20_03/image-20200302123314790.png)

## **C. Effects of Diversity Weight** **Î»**

![image-20200302123333473](/img/in-post/20_03/image-20200302123333473.png)

> ä»å››ä¸ªæ•°æ®é›†çš„è¶‹åŠ¿å¯ä»¥çœ‹å‡ºï¼ŒÎ»å€¼è¶Šå¤§ï¼Œåˆ†ç±»ç²¾åº¦è¶Šé«˜ï¼Œè€ŒÎ»å€¼è¿‡å¤§ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚
>
> åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé‡‡ç”¨äº¤å‰éªŒè¯æŠ€æœ¯æ¥é€‰æ‹©åˆé€‚çš„Î»æ¥æ»¡è¶³ä¸åŒä»»åŠ¡çš„ç‰¹æ®Šè¦æ±‚ã€‚

## **D. Effects of Neighbor Size**  

![image-20200302123402241](/img/in-post/20_03/image-20200302123402241.png)

## **E. Classification Results and Classification Maps**

## ![image-20200302123408751](/img/in-post/20_03/image-20200302123408751.png)

![image-20200302123432385](/img/in-post/20_03/image-20200302123432385.png)

