# 参考

[深度度量学习的这十三年，难道是错付了吗？](https://www.jiqizhixin.com/articles/2020-05-16-5)

# 概念

度量学习的**对象**通常是**样本特征向量的距离**，度量学习的**目的**是通过训练和学习，**减小或限制同类样本之间的距离，同时增大不同类别样本之间的距离。**

度量学习 (Metric Learning) == 距离度量学习 (Distance Metric Learning，DML) == 相似度学习,  是人脸识别中常用的机器学习方法

## 与经典识别网络的区别 (优势)

- **不需要提前设定类别数, 适合有未知样本的时候.**   因此，Metric Learning作为经典识别网络的替代方案，可以很好地适应某些特定的图像识别场景。**`一种较好的做法，是丢弃经典神经网络最后的softmax层，改成直接输出一个feature vector，去特征库里面按照Metric Learning寻找最近邻的类别作为匹配项。`**

>  **经典识别网络有一个bug：必须提前设定好类别数，例如softmax loss。**
> **这也就意味着，每增加一个新种类，就要重新定义网络模型，并从头训练一遍。**
>
> 比如我们要做一个门禁系统，每增加或减少一个员工(等于是一个新类别)，就要修改识别网络并重新训练。很明显，这种做法在某些实际运用中很不科学。
>
> - 训练和测试人脸识别分类器的时候经常被提到的**Open-set 和Close-set**：
>   close-set，就是所有的测试集都在训练集中出现过。所以预测结果是图片的ID，如果想要测试两张图片是否是同一个，那么就看这两张图片的预测ID是否一样即可。
>   open-set，就是测试的图片并没有在训练集中出现过，**那么每张测试图片的预测结果是特征向量，如果想要比较两张图片的人脸是否属于同一个人，需要测试图像特征向量的距离**。
>
> 理想的Open-set就需要度量学习，人脸识别学习到的特征应当在特定的度量空间中，**满足同一类的最大类内距离小于不同类的最小类间距离。**然后再使用最近邻检索就可以实现良好的人脸识别和人脸验证性能。
> 然而softmax loss仅仅能够使得特征可分，还不能够使得特征具有可判别性，所以需要对softmax loss进行改造。



### **基本流程**：

一般的度量学习包含以下步骤：

- **Encoder编码**模型：用于把原始数据编码为特征向量（重点如何训练模型）
- **相似度判别**算法：将一对特征向量进行相似度比对（重点如何计算相似度，阈值如何设定）

### **关键问题**：

- 网络设计：代表有孪生神经网络（Siamese network）
- hard negative mining：**找出难以区分的样本，更利于训练收敛。**
- pairs weighting/pair-based loss functions：**改进loss函数，促使网络优化， 使具有相同标签的样本在嵌入空间中尽量接近 ，具有不同标签的样本在嵌入空间中尽量远离。**

## 