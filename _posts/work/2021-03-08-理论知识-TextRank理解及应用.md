# åŸç†

## Textrankæ€»ç»“

### TextRankç‰¹ç‚¹ï¼š

æ­¤ç§ç®—æ³•çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯å¯ä»¥**è„±ç¦»è¯­æ–™åº“**çš„èƒŒæ™¯ï¼Œ**ä»…å¯¹å•ç¯‡æ–‡æ¡£**è¿›è¡Œåˆ†æå°±å¯ä»¥æå–è¯¥æ–‡æ¡£çš„å…³é”®è¯ã€‚åŸºæœ¬æ€æƒ³æ¥æºäºGoogleçš„PageRankç®—æ³•ã€‚

ä¸PageRankä¸åŒçš„æ˜¯ï¼ŒPageRankä¸­æ˜¯æœ‰å‘è¾¹ï¼Œè€ŒTextRankä¸­æ˜¯æ— å‘è¾¹ï¼Œæˆ–è€…è¯´æ˜¯åŒå‘è¾¹ã€‚

### TextRank ç”¨äºå…³é”®è¯æå–çš„**ç®—æ³•æµç¨‹**å¦‚ä¸‹ï¼š

1. æŠŠç»™å®šçš„æ–‡æœ¬ T æŒ‰ç…§å®Œæ•´å¥å­è¿›è¡Œ**åˆ†å‰²**ï¼Œå³:T=[S1,S2,â€¦,Sm]
2. å¯¹äºæ¯ä¸ªå¥å­ï¼Œè¿›è¡Œåˆ†è¯å’Œ**è¯æ€§æ ‡æ³¨**å¤„ç†ï¼Œå¹¶è¿‡æ»¤æ‰åœç”¨è¯ï¼Œ**åªä¿ç•™æŒ‡å®šè¯æ€§çš„å•è¯**ï¼Œå¦‚åè¯ã€åŠ¨è¯ã€å½¢å®¹è¯ï¼Œå…¶ä¸­ ti,j æ˜¯ä¿ç•™åçš„å€™é€‰å…³é”®è¯ã€‚Si=[ti,1,ti,2,...,ti,n]
3. **æ„å»ºå€™é€‰å…³é”®è¯å›¾** G = (V,E)ï¼Œå…¶ä¸­ V ä¸ºèŠ‚ç‚¹é›†ï¼Œç”±ï¼ˆ2ï¼‰ç”Ÿæˆçš„å€™é€‰å…³é”®è¯ç»„æˆï¼Œç„¶åé‡‡ç”¨å…±ç°å…³ç³»ï¼ˆCo-Occurrenceï¼‰æ„é€ ä»»ä¸¤ç‚¹ä¹‹é—´çš„è¾¹ï¼Œä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´å­˜åœ¨è¾¹ä»…å½“å®ƒä»¬å¯¹åº”çš„è¯æ±‡åœ¨é•¿åº¦ä¸ºK çš„çª—å£ä¸­å…±ç°ï¼ŒKè¡¨ç¤ºçª—å£å¤§å°ï¼Œå³æœ€å¤šå…±ç° K ä¸ªå•è¯ã€‚
4. æ ¹æ® TextRank çš„å…¬å¼ï¼Œ**è¿­ä»£ä¼ æ’­å„èŠ‚ç‚¹çš„æƒé‡**ï¼Œç›´è‡³æ”¶æ•›ã€‚
5. å¯¹èŠ‚ç‚¹æƒé‡è¿›è¡Œ**å€’åºæ’åº**ï¼Œä»è€Œå¾—åˆ°æœ€é‡è¦çš„ T ä¸ªå•è¯ï¼Œä½œä¸ºå€™é€‰å…³é”®è¯ã€‚
6. ç”±ï¼ˆ5ï¼‰å¾—åˆ°æœ€é‡è¦çš„ T ä¸ªå•è¯ï¼Œåœ¨åŸå§‹æ–‡æœ¬ä¸­è¿›è¡Œ**æ ‡è®°**ï¼Œè‹¥å½¢æˆç›¸é‚»è¯ç»„ï¼Œåˆ™ç»„åˆæˆå¤šè¯å…³é”®è¯ã€‚

### è¿­ä»£è®¡ç®—å…¬å¼ï¼š

<img src="https://cdn.jsdelivr.net/gh/sunqinghu/PicRepo/img/2020/v2-04b2c330a7f471e8b93f78963e6c1619_720w-20210501200224199.jpg" alt="img" style="zoom: 50%;" />

å¯ä»¥çœ‹å‡ºï¼Œè¯¥å…¬å¼ä»…ä»…æ¯”PageRank**å¤šäº†ä¸€ä¸ªæƒé‡é¡¹Wji**ï¼Œç”¨æ¥è¡¨ç¤º**ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¾¹è¿æ¥æœ‰ä¸åŒçš„é‡è¦ç¨‹åº¦**ã€‚è€ƒè™‘åˆ°ä¸åŒè¯å¯¹å¯èƒ½æœ‰ä¸åŒçš„å…±ç°ï¼ˆco-occurrenceï¼‰ï¼Œ**TextRankå°†å…±ç°ä½œä¸ºæ— å‘å›¾è¾¹çš„æƒå€¼**ã€‚

### å…³é”®è¯æå–åº”ç”¨

#### TextRankç”¨äºå…³é”®è¯æå–

#### TextRankç®—æ³•æå–å…³é”®è¯çŸ­è¯­

æå–å…³é”®è¯çŸ­è¯­çš„æ–¹æ³•åŸºäºå…³é”®è¯æå–ï¼Œå¯ä»¥ç®€å•è®¤ä¸ºï¼šå¦‚æœæå–å‡ºçš„**è‹¥å¹²å…³é”®è¯åœ¨æ–‡æœ¬ä¸­ç›¸é‚»**ï¼Œé‚£ä¹ˆæ„æˆä¸€ä¸ªè¢«æå–çš„å…³é”®çŸ­è¯­ã€‚

#### TextRankç”Ÿæˆæ‘˜è¦

ã€€ã€€å°†æ–‡æœ¬ä¸­çš„æ¯ä¸ª**å¥å­åˆ†åˆ«çœ‹åšä¸€ä¸ªèŠ‚ç‚¹**ï¼Œå¦‚æœä¸¤ä¸ªå¥å­æœ‰ç›¸ä¼¼æ€§ï¼Œé‚£ä¹ˆè®¤ä¸ºè¿™ä¸¤ä¸ªå¥å­å¯¹åº”çš„èŠ‚ç‚¹ä¹‹é—´å­˜åœ¨ä¸€æ¡æ— å‘æœ‰æƒè¾¹ã€‚è€ƒå¯Ÿ**å¥å­ç›¸ä¼¼åº¦**çš„æ–¹æ³•æ˜¯ä¸‹é¢è¿™ä¸ªå…¬å¼ï¼š



![img](https://cdn.jsdelivr.net/gh/sunqinghu/PicRepo/img/2020/v2-6f2cdbb2e228a23d26ba303c9e958017_720w.jpg)



> å…¬å¼ä¸­ï¼ŒSi,Sjåˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªå¥å­è¯çš„ä¸ªæ•°æ€»æ•°ï¼ŒWkè¡¨ç¤ºå¥å­ä¸­çš„è¯ï¼Œé‚£ä¹ˆåˆ†å­éƒ¨åˆ†çš„æ„æ€æ˜¯**åŒæ—¶å‡ºç°åœ¨ä¸¤ä¸ªå¥å­ä¸­çš„åŒä¸€ä¸ªè¯çš„ä¸ªæ•°**ï¼Œåˆ†æ¯æ˜¯å¯¹å¥å­ä¸­è¯çš„ä¸ªæ•°æ±‚å¯¹æ•°ä¹‹å’Œã€‚åˆ†æ¯è¿™æ ·è®¾è®¡å¯ä»¥**éåˆ¶è¾ƒé•¿çš„å¥å­åœ¨ç›¸ä¼¼åº¦è®¡ç®—ä¸Šçš„ä¼˜åŠ¿**ã€‚

æˆ‘ä»¬å¯ä»¥æ ¹æ®ä»¥ä¸Šç›¸ä¼¼åº¦å…¬å¼å¾ªç¯è®¡ç®—ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œ**æ ¹æ®é˜ˆå€¼å»æ‰ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´ç›¸ä¼¼åº¦è¾ƒä½çš„è¾¹è¿æ¥**ï¼Œæ„å»ºå‡ºèŠ‚ç‚¹è¿æ¥å›¾ï¼Œç„¶åè®¡ç®—TextRankå€¼ï¼Œæœ€åå¯¹æ‰€æœ‰TextRankå€¼æ’åºï¼Œ**é€‰å‡ºTextRankå€¼æœ€é«˜çš„å‡ ä¸ªèŠ‚ç‚¹å¯¹åº”çš„å¥å­**ä½œä¸ºæ‘˜è¦ã€‚

## ç†è§£PageRank

PageRank (PR)æ˜¯ä¸€ç§ç”¨äºè®¡ç®—ç½‘é¡µæƒé‡çš„ç®—æ³•ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ**æ‰€æœ‰çš„ç½‘é¡µçœ‹åšä¸€ä¸ªæœ‰å‘å›¾**ã€‚åœ¨è¿™ä¸ªå›¾ä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªç½‘é¡µã€‚å¦‚æœç½‘é¡µAæœ‰åˆ°ç½‘é¡µBçš„é“¾æ¥ï¼Œåˆ™å¯ä»¥è¡¨ç¤ºä¸ºAåˆ°Bçš„ä¸€æ¡æœ‰å‘è¾¹ã€‚

åœ¨æˆ‘ä»¬æ„é€ å®Œæ•´ä¸ªå›¾ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼ä¸ºç½‘é¡µåˆ†é…æƒé‡ã€‚

![img](/img/in-post/20_07/1*hheHfLOTjPW3uSsSxWKylQ.png)



> $$
> \sum_{æ‰€æœ‰è¿›å…¥é“¾æ¥j}\frac{jçš„æƒé‡}{jçš„å‡ºé“¾æ•°é‡}
> $$
>
> æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç½‘é¡µçš„æƒé‡e**å–å†³äºå…¶å…¥ç«™é¡µé¢çš„æƒé‡**ã€‚æˆ‘ä»¬éœ€è¦è¿è¡Œè¿™ä¸ªè¿­ä»£å¾ˆå¤šæ—¶é—´æ¥è·å¾—æœ€ç»ˆçš„æƒé‡ã€‚åˆå§‹åŒ–æ—¶ï¼Œæ¯ä¸ªç½‘é¡µçš„é‡è¦æ€§ä¸º1ã€‚

## å®ç°PageRank â€” å®ä¾‹

<img src="/img/in-post/20_07/1*DkZjlRNEjPSc8RNL7yWggA.jpeg" alt="img" style="zoom:50%;" />

use a **matrix** to represent the inbound and outbound links 

<img src="/img/in-post/20_07/1*dbzhpH6gbbraRloOz-oHmw.png" alt="img" style="zoom:33%;" />

According to the `1/|Out(Vi)|` from the function, we should **normalize** each column.

<img src="/img/in-post/20_07/1*ppIReXWpavbuvAHfi08EGw.png" alt="img" style="zoom: 33%;" />

We use this matrix to **multiply** with the weight of all nodes.

<img src="/img/in-post/20_07/1*n-Zp7ZjPMuw_p99UO_qDzA.jpeg" alt="img" style="zoom:50%;" />

We can use Python to **iterate** many times.

```python
import numpy as np
g = [[0, 0, 0, 0],
     [0, 0, 0, 0],
     [1, 0.5, 0, 0],
     [0, 0.5, 0, 0]]
g = np.array(g)
pr = np.array([1, 1, 1, 1]) # initialization for a, b, e, f is 1
d = 0.85
for iter in range(10):
    pr = 0.15 + 0.85 * np.dot(g, pr)
    print(iter)
    print(pr)
```

```
0
[0.15  0.15  1.425 0.575]
1
[0.15    0.15    0.34125 0.21375]
2
[0.15    0.15    0.34125 0.21375]
3
[0.15    0.15    0.34125 0.21375]
4
[0.15    0.15    0.34125 0.21375]
5
[0.15    0.15    0.34125 0.21375]
6
[0.15    0.15    0.34125 0.21375]
7
[0.15    0.15    0.34125 0.21375]
8
[0.15    0.15    0.34125 0.21375]
9
[0.15    0.15    0.34125 0.21375]
10
[0.15    0.15    0.34125 0.21375]
```

We also can change the code correspondingly.



## é€šè¿‡TextRankæå–å…³é”®å­—

PageRankæ˜¯ç½‘é¡µæ’åï¼ŒTextRankæ˜¯**æ–‡æœ¬æ’å**ã€‚PageRankä¸­çš„ç½‘é¡µå°±æ˜¯TextRankä¸­çš„æ–‡æœ¬ï¼Œæ‰€ä»¥åŸºæœ¬æ€è·¯æ˜¯ä¸€æ ·çš„ã€‚

<img src="/img/in-post/20_07/1*JeYlqJTA5MpKsaWwHkhKQw-20210501135202741.jpeg" alt="img" style="zoom:80%;" />



æˆ‘ä»¬å°†æ–‡æ¡£åˆ†æˆå‡ ä¸ªå¥å­ï¼Œå¹¶ä¸”åªå­˜å‚¨å¸¦æœ‰**ç‰¹å®šPOSæ ‡ç­¾**çš„å•è¯ã€‚æˆ‘ä»¬ä½¿ç”¨`spaCy`è¿›è¡Œè¯æ€§æ ‡æ³¨ã€‚

æˆ‘ä»¬æŠŠè¿™ä¸€æ®µåˆ†æˆä¸‰å¥è¯ã€‚

å› ä¸ºå¥å­ä¸­çš„å¤§å¤šæ•°å•è¯å¯¹ç¡®å®šé‡è¦æ€§æ²¡æœ‰ç”¨å¤„ï¼Œæˆ‘ä»¬**åªè€ƒè™‘å¸¦æœ‰åè¯ã€PROPNã€åŠ¨è¯è¯æ€§æ ‡ç­¾çš„å•è¯**ã€‚è¿™æ˜¯å¯é€‰çš„ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨æ‰€æœ‰çš„å•è¯ã€‚

Output

```
[[Wandering, Earth, described, China, budget, science, fiction, thriller, screens, AMC, theaters, North, America, weekend, shows, filmmaking, focused, spectacles, China, epics], [time, Wandering, Earth, feels, throwback, eras, filmmaking], [film, cast, setting, tone, science, fiction, fans, going, lot, screen, reminds, movies]]
```



æ¯ä¸ªå•è¯éƒ½æ˜¯PageRankä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚æˆ‘ä»¬å°†çª—å£å¤§å°è®¾ä¸ºkã€‚

![1*YdjbC0NcNnAkGf3sWPTAiA](/img/in-post/20_07/1*YdjbC0NcNnAkGf3sWPTAiA.png)

$[w1, w2, w_k]ã€[w2,w3,w_ {k + 1}], [w3, w4, w_ {k + 2}]$ä¸º`windows`ã€‚æˆ‘ä»¬è®¤ä¸º**çª—å£ä¸­çš„ä»»ä½•ä¸¤å­—å¯¹éƒ½æœ‰æ— å‘è¾¹**ã€‚

æˆ‘ä»¬ä»¥[time, Wandering, Earth, feels, throwback, eras, filmmaking]ä¸ºä¾‹ï¼Œå°†çª—å£å¤§å°è®¾ä¸ºk=4ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åˆ°äº†4ä¸ªçª—å£ï¼Œ[time, Wandering, Earth, feels, throwback]ï¼Œ [Earth, feels, throwback, eras]ï¼Œ [feels, throwback, eras, filmmaking]ã€‚

å¯¹äº[time, Wandering, Earth, feels]ï¼Œä»»ä½•ä¸¤ä¸ªè¯å¯¹éƒ½æœ‰ä¸€ä¸ªæ— å‘è¾¹ã€‚æˆ‘ä»¬å¾—åˆ°(time, Wandering), (time, Earth), (time, feels), (Wandering, Earth), (Wandering, feels), (Earth, feels)

æ ¹æ®è¿™ä¸ªå›¾ï¼Œæˆ‘ä»¬å¯ä»¥**è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹(å•è¯)çš„æƒé‡**ã€‚æœ€é‡è¦çš„è¯å¯ä»¥ç”¨ä½œå…³é”®è¯ã€‚ğŸš©





## å…³é”®è¯æå–çš„å®ç°

åœ¨è¿™é‡Œï¼Œæˆ‘ç”¨Pythonå®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨spaCyæ¥è·å–å•è¯çš„POSæ ‡è®°ã€‚

```python
text = '''
The Wandering Earth, described as Chinaâ€™s first big-budget science fiction thriller, quietly made it onto screens at AMC theaters in North America this weekend, and it shows a new side of Chinese filmmaking â€” one focused toward futuristic spectacles rather than Chinaâ€™s traditionally grand, massive historical epics. At the same time, The Wandering Earth feels like a throwback to a few familiar eras of American filmmaking. While the filmâ€™s cast, setting, and tone are all Chinese, longtime science fiction fans are going to see a lot on the screen that reminds them of other movies, for better or worse.
'''

tr4w = TextRank4Keyword()
tr4w.analyze(text, candidate_pos = ['NOUN', 'PROPN'], window_size=4, lower=False)
tr4w.get_keywords(10)
```

Output

```
science - 1.717603106506989
fiction - 1.6952610926181002
filmmaking - 1.4388798751402918
China - 1.4259793786986021
Earth - 1.3088154732297723
tone - 1.1145002295684114
Chinese - 1.0996896235078055
Wandering - 1.0071059904601571
weekend - 1.002449354657688
America - 0.9976329264870932
budget - 0.9857269586649321
North - 0.9711240881032547
```



# å‚è€ƒ

[Understand TextRank for Keyword Extraction by Python](https://towardsdatascience.com/textrank-for-keyword-extraction-by-python-c0bae21bcec0)

