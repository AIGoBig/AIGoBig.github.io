1. 中文版可以用来发大论文的时候用，所以也要用自己的话好好写，**参照MDL写**
2. **中文版要发大论文，参照震哥的格式和MDL的内容进行书写**
3. **英文版发RS，参照MDL进行翻译，RS SCI二级期刊**
4. **加油 找工作前 2月24前肝完啊，之后专心准备找工作，抓紧啊**

工作评级会用到啊

一投就中，加油啊

实验要好好做做啊

先完成，再完美啊

不要让老师失望啊

上一届前都没有啊

读博的先决条件啊

不投浪费可惜了啊

跟工资评级有关啊

|      |                            |          |           |
| ---- | -------------------------- | -------- | --------- |
| 12   | Abstract                   |          | ✅（2.15） |
| 13   | 1. Introduction            |          | ✅（2.18） |
| 14   | 2. Methodology             | 2.1，2.2 |           |
| 15   |                            | 2.3      |           |
| 16   | 3. Experimental Results    | 3.1，3.2 |           |
| 17   |                            | 3.3      |           |
| 18   |                            | 3.3      |           |
| 19   | 4. Conclusions，References |          |           |
| 20   | 优化表图                   |          |           |
| 21   | 排版                       |          |           |
| 22   |                            |          |           |
| 23   | **截止**                   |          |           |



基于多任务学习和度量学习的高光谱图像分类及未知类识别

Hyperspectral Image Classification With Unknown Classes Using Multi-task Learning and Metric Learning

# Abstract

基于深度学习的高光谱图像分类方法可以很好的提取高光谱图像的光谱和空间信息。

**但是**，目前在高光谱图像分类上使用的方法基本都假设在未知数据中没有新颖的类别，但是此假设对于现实世界太过严格，以致于构建的分类系统会忽略新颖的类并将其错分为某一种已知类别，导致高估已知的土地覆被；而且在实际的高光谱图像中往往很难获取足够的训练样本，因此仅使用有监督学习来训练神经网络往往难以使模型学习到足够的特征来进行有效高光谱图像分类和未知类识别。

**为解决这些问题，本文提出，**在开放的高光谱图像分类任务中，首先使用全样本对网络进行预训练，之后利用少量样本对网络进行微调并，采用特征相似性度量和对抗学习的**集成学习**方法更好的解决传统神经网络无法识别未知类别的问题，同时利用高光谱图像分类任务和未知类识别任务的**多任务学习**方式来共同训练特征提取网络。

**该模型**不仅通过使用对抗学习的方法缓解了开放的现实世界中高光谱数据集中训练样本不足的问题，还使用特征相似性度量及对抗学习的方法解决传统神经网络无法识别未知类别的问题，并通过多任务学习和集成学习的方式有效的提高了高光谱图像的分类及未知类识别效果。

**在**2个开放的高光谱数据集中均取得了很好的效果

关键词：高光谱图像分类 未知类识别 卷积神经网络 对抗学习 特征嵌入 集成学习

# Introduction

高光谱图像被广泛用于农业计划[1]，防灾[2]，资源勘探[3]，环境监测[4]等领域。根据应用的不同，可以将遥感影像映射为3-4个类别（不渗透，植被，水，有时甚至是贫瘠的）或10多个细粒度的类别[4] – [6]。土地覆被分类系统是多层次的。另一方面，遥感图像的来源是多种多样的，因此**很难重用以前的数据集**。因此，**提高HSI的分类精度**可以提高目标检测的精度，使资源检测更加准确，并使环境监测更加全面，从而进一步提高了工作效率，节省了工程成本。高光谱图像包含大量的空间和光谱信息，但是通常很难获得**足够的训练样本**，从而导致“维数灾难”。因此，使用特征选择和特征提取来进行**降维操作**在HSI的分类和处理中通常很重要。但是无论是特征选择还是特征提取，都可能在一定程度上影响HSI的结构信息与光谱带之间的相关性。在**深度学习时代**，新颖的卷积神经网络（CNN），递归神经网络和图卷积网络开始在高光谱和遥感数据的分类中占主导地位[9]，[28]-[34]。手动特征工程被深度网络的自动特征学习所取代。现在，高光谱图像分类以足够的训练样本以99％的分类精度进入了阶段[35]。**但是**，未知类或新颖类的存在将导致误报，从而降低模型的精度。如果许多属于未知类的实例被分类为已知类，则已知类的数量将大大高估。不幸的是，在现实世界中，即使不是不可能，也很难定义所有潜在类别。如前所述，由于预算限制，基于现场调查的样本收集只能覆盖研究区域的一小部分。例如，[39]沿主要道路网络收集了地面真实数据，而那些被掩埋在远离道路网络的地方不可避免地被忽略了。因此，对收集的样本进行训练的机器学习模型可能会遇到一些无法分类为已知类别之一的实例。尽管取决于图像的区域，但**未知类别的影响**甚至可能出现在很小的研究区域中。 帕维亚大学数据集是最受欢迎的高光谱基准之一，它记录了610×340区域中的九种土地覆盖类别，并进行了1.3 m地面采样 距离（GSD），约为793×442 m2。这个数据集很小，几乎没有覆盖校园。但是，有一个游泳池不应该属于这九类。我们在图1中显示了Pavia大学数据的伪彩色图，其中游泳池位于图像的右上角。机器需要从已知类别中分辨出未知事物。**对于许多算法来说，这是不可能的**，因为它们假定为封闭环境。例如，深层神经网络受到SoftMax函数的限制，该函数将输出概率限制为总和为1，并且每个概率在0到1之间。在这种情况下，必须为输入实例分配一个已知的类。一个简单的解决方案是使用置信度阈值，拒绝那些分类信度低的对象。但是，低的分类置信度不能保证未知。即当前的高光谱图像分类任务通常假定分类系统是封闭且完整的，并且要求在未知数据中没有未知或新颖的类别。但是此假设对于现实世界太过严格，以致于构建的分类系统会忽略新颖的类，并将其错分为某一种已知类别，导致高估已知的土地覆被（例如农作物面积）。

**为了解决上述问题**，**目前**，提出了一些用于日常图像识别的方法。他们首先被[46]称为开放集识别，他们引入了1-vs-set机器来赋予SVM识别未知数的能力。在深度学习的背景下，OpenMax方法是解决该问题的第一个方法[49]，它使网络能够估计一个实例成为未知类的可能性。它使用激活向量（SoftMax之前最后一层的输出特征）估计每个类别的距离分布，然后应用极值理论用C + 1个类别重新校准激活向量，其中添加的类别是未知的。 [50]建议使用从生成对抗网络生成的反事实图像作为未知数来训练分类器。此外，[51]认为使用背景类来减少网络的厌恶恐惧症。此外，[52]添加了一个辅助任务来增强OpenMax方法的潜在功能。这种名为CROSR的开放集识别增强方法已通过异常检测算法（即IsoForest和一类SVM）以类的方式进行了测试，以有效地利用潜在特征。该方法实现了开放式识别的最新技术。但是，像其他方法一样，仍然需要大量训练样本来估计每个类别的质心，从而限制了其在高光谱图像分类中的性能。 **但是，**由于高光谱图像分类与日常图像开放集识别之间的显著差异，该问题仍然是高光谱图像技术领域有待解决的重要问题。解决开放数据集的问题首先是在自然图像上被提出，但是由于高光谱图像分类与日常图像开放集识别之间的显著差异，该问题仍然是高光谱图像技术领域有待解决的重要问题。

**因此，现有方法仍然存在许多问题**，包括无法利用全部样本而导致的网络训练不充分，无法解决传统神经网络无法识别未见过的类别的问题。因此，在样本量较小且存在未知类的情况下，如何充分利用高光谱的空谱特征进行分类以及对未知类进行识别，是高光谱图像技术领域需要研究、有待解决的重要问题。

**本文的主要贡献如下**：

1. 为了缓解训练样本不足的问题：在开放的高光谱数据集中，通过对抗学习的方法，将所有样本输入到特征提取网络提取特征向量，并通过生成器网络实现重建任务，然后利用标记样本对网络进行微调以完成分类任务。该过程可以利用大量的未标记样本，能够获得鲁棒且强大的HSI分类识别特征, 也通过对抗学习间接提高了分类任务的判别和泛化能力。从而实现基于数据的对抗任务和分类任务的多任务学习方法来共同提高网络的特征提取能力，进而提高网络的分类精度。
2. 为了解决传统神经网络无法识别未见过的类别的问题：首先通过卷积神经网络提取到输入样本的特征向量，然后使用特征度量的方式对输入样本的特征向量与有标签样本的特征向量的相似性进行度量，从而可以对其进行检索分类，并与生成对抗网络同时判别其是否为未知类，完成在开放的高光谱图像数据集上的分类任务和未知类识别的任务。



# Methodology

2.1. 深度特征融合CNN进行分类 🚩

2.2. 通过多任务学习重建 

2.3. 多任务注意力机制权重调节 



## 深度特征融合CNN进行分类 🚩

**此处应该有图**

>  Figure 1. 处理高光谱图像分类的多任务多尺度和多级光谱空间特征融合网络（MTMSSN）的流程图

深度神经网络在HSI分类任务上已经取得了很好的效果。**但是，**随着网络模型复杂度的增加，分类精度却会由于过拟合而导致下降。**首先**，通常的高光谱图像分类模型只使用少量样本来训练复杂的网络模型会导致过度拟合现象，从而导致分类精度降低。**其次，**使用反向传播计算导数时，反向传播的梯度的幅度值会随网络深度的增加而急剧减小，以致于整个损失函数的导数相对于前几层的权重非常小。这样，当使用梯度下降法时，初始层的权重变化非常缓慢，这意味着它们无法有效地从样本中学习特征。🚩**但是，**通过在层之间添加短路连接以构造残差块，可以减少精度降低的问题[35]；通过对抗学习方法可以利用到全量样本进行网络训练，从而缓解高光谱图像分类任务训练样本少而导致的网络训练不充分的问题。**因此我们**设计了深度残差块网络提取图像特征，用生成网络重建样本预训练分类卷积神经网络和反卷积神经网络，从而可以充分利用到所有的样本训练网络，避免网络过拟合，从而在解决梯度消失问题的同时提高了分类精度。

<img src="/img/in-post/20_07/image-20210219211136507.png" alt="image-20210219211136507" style="zoom:33%;" />

>  Figure 2. 特征提取网络、重建网络、预测网络

图1为所提出的方法的流程图。 这里使用的多任务网络获取了9×9×channel的输入。网络的第一部分是具有两个残差单元[59]和全局平均池化层[60]的**编码器/特征提取器**。**分类部分**是添加全局平均池中时的修改版本的HRESNet [43]， 在提取潜在特征后，具有softmax功能的全连接层用作**分类器**并将概率输出到已知类。 这里的重建任务使用**反卷积层**逐渐增加潜在特征的空间尺寸。 重建任务的输出是9×9×通道的实例，它应该通过最小化L1损失来近似于输入数据。 **EVT**模拟重建损失以**分离已知和未知的类别**。















1. 为了缓解训练样本不足的问题：在开放的高光谱数据集中，通过对抗学习的方法，将所有样本输入到特征提取网络提取特征向量，并通过生成器网络实现重建任务，然后利用标记样本对网络进行微调以完成分类任务。该过程可以利用大量的未标记样本，能够获得鲁棒且强大的HSI分类识别特征, 也通过对抗学习间接提高了分类任务的判别和泛化能力。从而实现基于数据的对抗任务和分类任务的多任务学习方法来共同提高网络的特征提取能力，进而提高网络的分类精度。
2. 为了解决传统神经网络无法识别未见过的类别的问题：首先通过卷积神经网络提取到输入样本的特征向量，然后使用特征度量的方式对输入样本的特征向量与有标签样本的特征向量的相似性进行度量，从而可以对其进行检索分类，并与生成对抗网络同时判别其是否为未知类，完成在开放的高光谱图像数据集上的分类任务和未知类识别的任务。

**研究难点：**

1. 在样本量较少的情况下，如何设计模型及模型融合方案使网络可以充分提取高光谱图像中丰富的光谱空间特征。
2. 如何在小样本，类别少和低开放度的数据中有效识别出未标记样本类别。
3. 如何在保证可以有效识别出未标记样本类别的同时可以达到比较高的HSI分类准确率。

| 任务                     | 样本数   | 未知类 | 开放度 | #类别数 | #通道数 |
| ------------------------ | -------- | ------ | ------ | ------- | ------- |
| 自然图像识别             | 通常>500 | 有     | 高     | 100+    | 1-4     |
| 高光谱图像分类           | 通常<50  | 无     | 无     | 20-     | 数百    |
| 有未知类的高光谱图像分类 | 通常<50  | 有     | 低     | 20-     | 数百    |

<!--如表所示，由于高光谱图像分类与日常图像开放集识别之间的三个显着差异（），很难直接使用开放集技术开发用于高光谱图像分类中的日常图像识别-->



**拟采用的研究方案**

1. 采用对抗学习的方式，利用无监督的方法充分利用未标记的样本，解决高光谱图像样本数量少的问题。使用特征度量的方式完成开放数据集上的分类任务和未知类识别的任务。

2. 考虑使用对比自监督的方式对模型进行更加有效的预训练。考虑相似度度量方式，尝试不同的深度度量学习方式来提取更有分辨能力的特征，使得网络更加关注对分类更有利的特征。

3. 考虑使用注意力机制、样本增强、迁移学习等方式进一步提高模型分类性能。

# Experimental Results



# Conclusions

在有未知类别的高光谱图像分类及未知类识别任务上，实现了光谱-空间特征融合的特征提取网络及对抗学习方法的应用，并取得了比较好的效果。



**假期研究计划（1月初 - 2月底）：**

1、继续改进预训练模型，利用无监督训练充分利用未标记的样本

a)  对进行相关知识的进一步了解，并优化实验方式，使数据更准确 

b)  调整实验参数，找出较好的模型参数

c)  考虑其他提升效果的方法和技巧

d)  进行实验分析及成果整理



2、使用特征度量的方式完成开放数据集上的分类任务和未知类识别的任务

a)  通过实验选择特征度量的加入方法（单独使用或与全连接层配合） 

b)  尝试不同的度量方式及嵌入特征提取方法，进行实验并记录结果

c)  进行实验分析及成果整理

3、结合上述两种方法的模型，完善实验代码，得到相关实验结果并进行分析。如果效果不佳则考虑加入其他模型，比如融合网络。



2021年3月至6月：尝试不同的深度度量学习方式来提取更有分辨能力的特征，使得网络更加关注对分类更有利的特征；尝试对比自监督的学习方式对模型进行更加有效的预训练。
2021年6月至2022年1月：尝试使用一些更有效的融合网络等，来构建更有效的模型；考虑使用注意力机制、样本增强、迁移学习等方式进一步提高模型分类性能。
2022年1月至2022年6月：进一步完善实验，完成硕士学位论文并准备答辩。

# References










