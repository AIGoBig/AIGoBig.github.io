---
layout: post
title: "è®ºæ–‡å­¦ä¹  (19TGRS)A CNN With Multiscale Convolution and Diversified Metric for Hyperspectral Image Classification"
subtitle: 'DPP-DML-MS-CNN'
author: "Sun"
header-style: text
tags:
  - Paper
  - DPP
  - DML
  - metric
  - CNN
---

# Abstract

IEEE Transactions on Geoscience and Remote Sensing, 2019, 57(6): 3599-3618.	

## Index

MS-CNN â†’ multi-scale feature

determinantal point process (DPP) 

deep metric learning(DML)

## Reference

[ç»“æ„åŒ–æŸå¤±çš„ç†è§£(Structural Risk)](jianshu.com/p/228606144383) 

[DPPåœ¨æ–‡æœ¬æ‘˜è¦ä¸­çš„åº”ç”¨:  << Improving the Similarity Measure of Determinantal Point Processes for Extractive Multi-Document Summarization>>](https://arxiv.org/abs/1906.00072v1)

## æå‡ºåŸå› 

è®­ç»ƒæ ·æœ¬æ•°é‡æœ‰é™ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå…·æœ‰**è¾ƒå¤§ç±»å†…æ–¹å·®å’Œä½ç±»é—´æ–¹å·®**çš„å›¾åƒï¼Œå­¦ä¹ çš„æ·±åº¦æ¨¡å‹é€šå¸¸ä¸æ˜¯æœ€ä¼˜çš„ã€‚

## åˆ›æ–°ç‚¹

* æå‡ºäº†ä¸€ç§å…·æœ‰**å¤šå°ºåº¦å·ç§¯**å’Œ**ä½¿ç”¨DPPæ–¹æ³•æ¥ä¿ƒè¿›å¤šæ ·æ€§çš„æ·±åº¦åº¦é‡**çš„æ–°å‹CNNï¼ˆ**DPP-DML-MS-CNN**ï¼‰ï¼Œè¯¥æ¨¡å‹åŒæ—¶åˆ©ç”¨äº†å¤šå°ºåº¦ç‰¹å¾å’Œå¤šæ ·åŒ–çš„æ·±åº¦åº¦é‡ï¼Œç”¨äºé«˜å…‰è°±å›¾åƒåˆ†ç±»ã€‚
  ![image-20200302104353207](/img/in-post/20_03/image-20200302104353207.png)

> ä¸ºäº†åŠ é€Ÿæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼Œé¦–å…ˆé€šè¿‡**é¢„è®­ç»ƒ**æ¥å­¦ä¹ MS-CNNçš„å‚æ•°ï¼Œ
>
> ç„¶åé‡‡ç”¨**å¾®è°ƒ**çš„æ–¹æ³•ç”¨ **åŸºäºDPPçš„ç»“æ„æŸå¤±**æ¥**å¾®è°ƒ**è®­ç»ƒæ·±åº¦æ¨¡å‹ ,è”åˆå­¦ä¹  MS-CNNçš„å‚æ•°W å’Œåº¦é‡å› å­Bã€‚
>
> æœ€åï¼Œå°†å­¦ä¹ åˆ°çš„ **åº¦é‡å› å­B** ä¹ŸåŠ å…¥åˆ° **æ·±åº¦æ¨¡å‹ä¸­** ç”¨äºä»é«˜å…‰è°±å›¾åƒä¸­æå–åˆ¤åˆ«ç‰¹å¾ã€‚

# MS-CNN

åœ¨æœ¬æ–‡ä¸­ï¼Œæå‡ºäº†å…·æœ‰å¤šå°ºåº¦å·ç§¯ï¼ˆMS-CNNï¼‰çš„æ–°å‹å·ç§¯ç¥ç»ç½‘ç»œï¼Œé€šè¿‡å°†å¤šå°ºåº¦æ»¤æ³¢å™¨ç»„åˆå¹¶åˆ°CNNä¸­, ä»é«˜å…‰è°±å›¾åƒä¸­**æå–æ·±å±‚å¤šå°ºåº¦ç‰¹å¾**ã€‚

è®¾è®¡äº†å¦‚ä¸‹ä¸‰ç§ç±»å‹çš„MS-CNNç»“æ„:

![image-20200302112453920](/img/in-post/20_03/image-20200302112453920.png)

![image-20200302112510439](/img/in-post/20_03/image-20200302112510439.png)

![image-20200302112517053](/img/in-post/20_03/image-20200302112517053.png)

> Notice:
>
> åˆ†åˆ«ä¸º1D MS-CNN, 2D MS-CNN, 3D MS-CNN
>
> 1D: é€šè¿‡æŠŠå¤šå°ºåº¦å·ç§¯çš„ç»“æ„åˆå¹¶åˆ°1D-CNNé‡Œå½¢æˆçš„, ç„¶åä½¿æ¯ä¸€ä¸ªå°ºåº¦çš„å·ç§¯ç»“æœæœ‰**ç›¸åŒé€šé“**æ•°, æœ€å**concat**åˆ°ä¸€èµ·
>
> 2D: ç”±äºç©ºé—´ç»“æ„çš„ç ´å, ä»ç„¶ä¸èƒ½å¾ˆå¥½åˆ©ç”¨**é‚»åŸŸç‰¹å¾**,é™ä½æ¨¡å‹è¡¨ç¤ºèƒ½åŠ›  
>
> 3D: **1*1ï¼Œ3\*3 å¤šå°ºåº¦æ»¤æ³¢å™¨ç»„æå–å¤šå°ºåº¦ç‰¹å¾**
>
> 1D - 3D: ä¹Ÿå¯ä»¥çœ‹å‡ºåº¦é‡è½¬æ¢(metric transformation) åœ¨æœ¬æ–‡è¢«å®ç°ä¸ºå…¨è¿æ¥å±‚

# **Deep metric learning** (DML)

**åº¦é‡**

å¥½çš„åº¦é‡å¯ä»¥æœ‰åŠ©äºæ‰¾åˆ°æ›´å¥½çš„ç‰¹å¾, æ„å»ºæ›´å¥½çš„æ¨¡å‹. åº¦é‡åˆ†ä¸ºæ˜¾å¼åº¦é‡å’Œéšå¼åº¦é‡. 

1. æ˜¾å¼åº¦é‡: å¦‚å¸¸ç”¨çš„æ¬§æ°è·ç¦»ã€é©¬æ°è·ç¦»ã€ä½™å¼¦ç›¸ä¼¼åº¦ç­‰, ä¸éœ€è¦å­¦ä¹ å³å¯è®¡ç®—å‡ºæ¥
2. éšå¼åº¦é‡: åœ¨ç‰¹å®šä»»åŠ¡ä¸­, å•çº¯çš„ç”¨è¿™äº›ç®€å•è·ç¦»å…¬å¼è¾¾ä¸åˆ°é¢„æœŸæ•ˆæœæ—¶, éœ€è¦**å¯¹éšå¼çš„è·ç¦»è¿›è¡Œå­¦ä¹ **, å³æ‰€è°“çš„åº¦é‡å­¦ä¹ .

**åº¦é‡å­¦ä¹ çš„ç›®æ ‡**

å­¦ä¹ ä¸€ä¸ªåº¦é‡ç›¸ä¼¼åº¦çš„è·ç¦»å‡½æ•°:  ä½¿ç›¸ä¼¼çš„ç›®æ ‡è·ç¦»è¿‘, ä¸ç›¸ä¼¼çš„ç›®æ ‡è·ç¦»è¿œ.

**åº¦é‡å­¦ä¹ çš„å‘å±•**

ä¹Ÿå’Œæœºå™¨å­¦ä¹ çš„å‘å±•æƒ…å†µå¤§æ¦‚ä¸€è‡´ï¼Œä»æœ€åˆçš„åŸºäºä¼ ç»Ÿæ–¹æ³•ï¼Œé€æ¸è¿‡æ¸¡åˆ°å¦‚ä»Šçš„åŸºäºæ·±åº¦ç¥ç»ç½‘ç»œã€‚åº¦é‡å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰ã€è§†é¢‘åˆ†æã€æ–‡æœ¬æŒ–æ˜ã€ç”Ÿç‰©ä¿¡æ¯å­¦ç­‰å¤šä¸ªé¢†åŸŸå‡æœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚å¯ä»¥è¯´ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ²¡æœ‰åº¦é‡ï¼Œå°±æ²¡æœ‰å¥½çš„æ¨¡å‹ã€‚å‡¡æ˜¯éœ€è¦ç”¨åˆ°æœºå™¨å­¦ä¹ çš„åœ°æ–¹ï¼Œéƒ½éœ€è¦åº¦é‡ã€‚

**åŸºäºæ·±åº¦å­¦ä¹ **çš„åº¦é‡å­¦ä¹ å…¶å‘å±•ä¸»è¦ä½“ç°åœ¨**ä¸åŒçš„Loss Functionä¸Š**, æœ€åŸºæœ¬çš„2ç§: Triplet-lose,Contrastive Loss.

**åŸºæœ¬æ€è·¯**

ç»™å®šè®­ç»ƒæ ·æœ¬, **æ ·æœ¬ä¸­åŒ…å«é¢„å…ˆè§‚æµ‹åˆ°çš„ä¸€äº›å¯¹äºæ ·æœ¬çš„çŸ¥è¯†(å…ˆéªŒ), å¦‚å“ªä¸¤ä¸ªæ ·æœ¬è·ç¦»æ›´è¿‘, å“ªä¸¤ä¸ªæ›´è¿œ. å­¦ä¹ ç®—æ³•ä»¥å…ˆéªŒä¸ºçº¦æŸå¹¶æ„å»ºç›®æ ‡å‡½æ•°, å­¦ä¹ è¿™äº›æ ·æœ¬é—´çš„ä¸€ä¸ªå¾ˆå¥½çš„åº¦é‡, å¹¶æ»¡è¶³é¢„å…ˆç»™å®šçš„é™åˆ¶æ¡ä»¶. ä»è¿™ç§æ„ä¹‰ä¸Šçœ‹ä¹Ÿå¯ä»¥çœ‹åšä¸ºä¸€ç§ç‰¹å®šæ¡ä»¶ä¸‹çš„ä¼˜åŒ–é—®é¢˜.** 

> åº¦é‡å­¦ä¹ åœ¨äººè„¸è¯†åˆ«ç­‰åº”ç”¨ä¸Š, æ­¤æ–¹æ³•å·²ç»å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœ

<img src="/img/in-post/20_03/image-20200305172916259.png" alt="image-20200305172916259" style="zoom:80%;" />

### **ç¼ºç‚¹**

ä½†æ˜¯ï¼Œåœ¨**åº¦é‡è½¬æ¢**ä¸­ç”¨ä¸€èˆ¬çš„ç»“æ„æŸå¤±æ¥å­¦ä¹ åº¦é‡å‚æ•°å› å­é€šå¸¸ä¼šä½¿å­¦ä¹ åˆ°çš„å› å­ä¹‹é—´å…·æœ‰**ç›¸ä¼¼æ€§**ã€‚è¿™ç§ç›¸ä¼¼æ€§å°†è´Ÿé¢å½±å“æ·±åº¦åº¦é‡æ¨¡å‹å¯¹é«˜å…‰è°±å›¾åƒçš„è¡¨ç¤ºèƒ½åŠ›ã€‚

1. HSI æ²¡æœ‰è¶³å¤Ÿæ ‡è®°çš„æ ·æœ¬
2. ä¸åŒç±»åˆ«æ ·æœ¬è¡¨ç°ç›¸ä¼¼ç‰¹å¾

**å› æ­¤å­¦ä¹ åˆ°çš„ç”¨äºè¡¨ç¤ºHSIçš„metric factorsæ˜æ˜¾å†—ä½™,ä¸åŒmetric factorsä»å›¾åƒæå–ç›¸ä¼¼ç‰¹å¾, å¯¼è‡´åˆ†ç±»æ€§èƒ½é™ä½**

### è§£å†³æ–¹æ³•

éœ€è¦åŠ å…¥æ­£åˆ™åŒ–æ–¹æ³•

1. æ–½åŠ ä¿ƒè¿›å¤šæ ·æ€§çš„å…ˆéªŒ, å¦‚ DPPå…ˆéªŒ

# Diversity-Promoting Learning

æœ¬æ–‡å°†ä¼šä½¿ç”¨**ç»“æ„åŒ–æŸå¤±çš„æ·±åº¦åº¦é‡å­¦ä¹ æ–¹æ³•**æ¥**è”åˆ**è®­ç»ƒå‰é¢æå‡ºçš„åˆ†ç±»æ¨¡å‹.

ä½†æ˜¯åœ¨åº¦é‡å˜æ¢ä¸­ï¼Œä¸€èˆ¬çš„ç»“æ„åŒ–æŸå¤±ä½¿å¾—å­¦ä¹ åˆ°çš„åº¦é‡å‚æ•°å› å­ä¹‹é—´å­˜åœ¨**ç›¸ä¼¼æ€§**, ä¼šè´Ÿé¢å½±å“**æ·±åº¦åº¦é‡æ¨¡å‹çš„è¡¨ç¤ºèƒ½åŠ›**.

ä¸ºäº†ä½¿å­¦ä¹ åˆ°çš„**åº¦é‡å‚æ•°å› å­å¤šæ ·åŒ–**ï¼Œå¹¶è¿›ä¸€æ­¥æé«˜æ·±åº¦åº¦é‡çš„è¡¨ç¤ºèƒ½åŠ›ï¼Œæå‡ºäº†ä¸€ç§**åŸºäºDPPçš„ç»“æ„åŒ–æŸå¤±**, å¯¹å­¦ä¹ åˆ°çš„åº¦é‡å‚æ•°å› å­æ–½åŠ **ç¡®å®šæ€§ç‚¹è¿‡ç¨‹ï¼ˆDPPï¼‰å…ˆéªŒ**ï¼Œä»¥**é¼“åŠ±å­¦ä¹ åˆ°çš„åº¦é‡å› å­ç›¸äº’æ’æ–¥**ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œä½¿ç”¨è¿™ç§**å…·æœ‰ç‰¹æ®Šç»“æ„æŸå¤±çš„æ·±åº¦åº¦é‡å­¦ä¹ æ–¹æ³•**ï¼Œä»¥**è”åˆè®­ç»ƒ**æ‰€æå‡ºçš„æ¨¡å‹ã€‚

```mermaid
graph LR
	M(åœ¨åº¦é‡è½¬åŒ–ä¸­å­¦ä¹  Metric Parameter Factors) -.ä½¿ç”¨ä¸€èˆ¬çš„structured loss.-> O(å­¦ä¹ åˆ°çš„deep factorsé—´å…·æœ‰ç›¸ä¼¼æ€§)
	M -.DPP Prior-based Structured loss.-> N(diversified Metric Factors) 
```

## A. Structured Loss for MS-CNNs

**ç»“æ„æŸå¤±Lç”¨äºæœ€å°åŒ–æ‰€æœ‰æ­£å¯¹ä¹‹é—´çš„è·ç¦»,å¹¶æƒ©ç½šäº†ç›¸åº”çš„è´Ÿå¯¹**

![image-20200302112957361](/img/in-post/20_03/image-20200302112957361.png)

ç‰¹å¾è·ç¦»å‡½æ•°:

![image-20200302113240820](/img/in-post/20_03/image-20200302113240820.png)

è´Ÿå¯¹æƒ©ç½šå‡½æ•°:

![image-20200302113246170](/img/in-post/20_03/image-20200302113246170.png)

> å…¶ä¸­, mæ˜¯ä¸€ä¸ªæ­£å€¼ï¼Œè¡¨ç¤ºå¯¹è´Ÿå¯¹è·ç¦»çš„æƒ©ç½šè¾¹ç•Œã€‚
> xi, xj: åŒä¸€ç±»åˆ«çš„æ ·æœ¬å¯¹(positive pairs) xi, xkï¼šä¸åŒç±»åˆ«æ ·æœ¬å¯¹(negative pairs)
> å¯ä»¥æ³¨æ„åˆ°ï¼Œ**Bå¯ä»¥çœ‹æˆæ˜¯çº¿æ€§æ˜ å°„ï¼Œå¯ä»¥è®­ç»ƒæˆMS-CNNä¸­çš„å…¨è¿æ¥å±‚ã€‚**

### **ç¼ºç‚¹**

ä½†æ˜¯ï¼Œç”±äºHSIå›¾åƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹:

1. HSI æ²¡æœ‰è¶³å¤Ÿæ ‡è®°çš„æ ·æœ¬
2. ä¸åŒç±»åˆ«æ ·æœ¬è¡¨ç°ç›¸ä¼¼ç‰¹å¾

> å¯ä»¥ç†è§£ä¸º, å‡å¦‚åªæœ‰2 ä¸ªç›¸åŒçš„æ ·æœ¬, åˆ™Metric factors åªèƒ½ä»è¿™ä¸¤ä¸ªæ ·æœ¬ä¸­æå–å¾ˆå°‘ä¸”ç›¸åŒçš„ç‰¹å¾, æ— æ³•å»ºç«‹ä¸€ä¸ªæœ‰æ•ˆçš„åˆ†ç±»æ¨¡å‹.

å› æ­¤åœ¨**åº¦é‡è½¬æ¢**ä¸­ç”¨**è¿™ç§ä¸€èˆ¬çš„ç»“æ„æŸå¤±**æ¥å­¦ä¹ åº¦é‡å‚æ•°å› å­é€šå¸¸ä¼šä½¿å­¦ä¹ åˆ°çš„å› å­ä¹‹é—´å…·æœ‰**ç›¸ä¼¼æ€§**ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œä½¿ä¸åŒmetric factors**é›†ä¸­æå–HSIç›¸ä¼¼ç‰¹å¾**ä¸Š, è¿™ä¼šå¯¼è‡´æ·±åº¦åº¦é‡å› å­æ˜æ˜¾å†—ä½™, å¯¼è‡´åˆ†ç±»æ€§èƒ½é™ä½

> å¯ä»¥ç†è§£ä¸º,ä¸åŒçš„å› å­æå–ä¸åŒçš„ç‰¹å¾, å½“featureç±»ä¼¼æˆ–è€…æ¯”è¾ƒå°‘æ—¶, èƒ½æå–æ›´åŠ specialçš„ç‰¹å¾

![image-20200306085006435](/img/in-post/20_03/image-20200306085006435.png)

>å¦‚å·¦å›¾ï¼Œæ²¡æœ‰DPPçš„æƒ…å†µä¸‹, å¸¦æœ‰ç´«è‰²æ ‡è®°çš„åŠŸèƒ½å°†è¢«å¿½ç•¥.
>
>**å¦‚å³å›¾, å³ä½¿è®­ç»ƒæ ·æœ¬æœ‰é™**ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å°†DPPå…ˆéªŒ**å¼ºåŠ äºå­¦ä¹ å› ç´ ä¸Šæ¥ä½¿å­¦ä¹ æ¨¡å‹å¤šæ ·åŒ–**ï¼Œå¹¶ä¸”ä¸åŒå› ç´ ç€é‡äºå¯¹ç‹¬ç‰¹ç‰¹å¾è¿›è¡Œå»ºæ¨¡ã€‚æœ€ç»ˆï¼Œæ‰€æœ‰**å› ç´ éƒ½å¯ä»¥ä»å›¾åƒä¸­æ¨¡æ‹Ÿå¾ˆå¤§æ¯”ä¾‹çš„ç‰¹å¾**ï¼Œä»è€Œæé«˜äº†åˆ†ç±»æ€§èƒ½

### **è§£å†³**

ä¸ºäº†é¼“åŠ±è¿™äº›å› ç´ å¤šæ ·åŒ–å¹¶è¿›ä¸€æ­¥æé«˜åˆ†ç±»æ€§èƒ½ï¼Œå¼•å…¥äº†æ­£åˆ™åŒ–æ–¹æ³•ã€‚è¯¥æ­£åˆ™åŒ–æ–¹æ³•æ—¨åœ¨**å°†è¾…åŠ©ä¿¡æ¯æ·»åŠ åˆ°å‚æ•°ä¼°è®¡ä¸­**ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥é¼“åŠ±å­¦ä¹ çš„å› ç´ æ»¡è¶³**ç‰¹å®šçš„å±æ€§**ã€‚å³, **general â†’ special**

æ‰€ä»¥æå‡ºäº†ä¸€ç§**åŸºäºDPPçš„ç»“æ„æŸå¤±**, å¯¹å­¦ä¹ åˆ°çš„åº¦é‡å‚æ•°å› å­æ–½åŠ ç¡®å®šæ€§ç‚¹è¿‡ç¨‹ï¼ˆDPPï¼‰å…ˆéªŒï¼Œä»¥**é¼“åŠ±å­¦ä¹ åˆ°çš„åº¦é‡å› å­ç›¸äº’æ’æ–¥**ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œä½¿ç”¨è¿™ç§**å…·æœ‰ç‰¹æ®Šç»“æ„æŸå¤±çš„æ·±åº¦åº¦é‡å­¦ä¹ æ–¹æ³•**ï¼Œä»¥**è”åˆè®­ç»ƒ**æ‰€æå‡ºçš„æ¨¡å‹ã€‚

## B. Determinantal Point Process Priors

é€šè¿‡**å®šä¹‰**å­¦ä¹ å› å­ä¹‹é—´çš„**æˆå¯¹ç›¸ä¼¼æ€§**ï¼ˆé€šå¸¸æ˜¯åŸºäºæ ¸å‡½æ•°ï¼‰ï¼ŒDPPå…ˆéªŒä¼šæ ¹æ®æ ¸çŸ©é˜µçš„**è¡Œåˆ—å¼**å°†**è¾ƒé«˜çš„æ¦‚ç‡**åˆ†é…ç»™ä¸€ç»„**ä¸åŒçš„å› å­**ã€‚åŒæ ·ï¼ŒDPPå…ˆéªŒå€¾å‘äº**å¤šæ ·çš„factors**.

![image-20200302113857348](/img/in-post/20_03/image-20200302113857348.png)

>  Î¸åœ¨æ­¤å¤„æ˜¯è¿ç»­ç©ºé—´, Bæ˜¯Î¸çš„ä»»æ„å­é›†
>
>  ğ‘(BâŠ‚Î¸) è¡¨ç¤ºBä¸­å…ƒç´ é‡‡æ ·ä¸­**è¢«å‘½ä¸­çš„æ¦‚ç‡**, å³Bçš„DPPå…ˆéªŒ
>
>  >**å…ˆéªŒæ¦‚ç‡**æ˜¯æŒ‡æ ¹æ®**ä»¥å¾€ç»éªŒå’Œåˆ†æå¾—åˆ°çš„æ¦‚ç‡**ï¼Œå¦‚å…¨æ¦‚ç‡å…¬å¼
>  >
>  >**åéªŒæ¦‚ç‡**çš„è®¡ç®—è¦ä»¥å…ˆéªŒæ¦‚ç‡ä¸ºåŸºç¡€ã€‚äº‹æƒ…å·²ç»å‘ç”Ÿ,è¦æ±‚è¿™ä»¶äº‹æƒ…å‘ç”Ÿçš„åŸå› æ˜¯ç”±æŸä¸ªå› ç´ å¼•èµ·çš„å¯èƒ½æ€§çš„å¤§å°. åéªŒæ¦‚ç‡å¯ä»¥æ ¹æ®é€šè¿‡è´å¶æ–¯å…¬å¼ï¼Œç”¨å…ˆéªŒæ¦‚ç‡å’Œä¼¼ç„¶å‡½æ•°è®¡ç®—å‡ºæ¥ã€‚
>
>  Î»å¯ä»¥è§†ä¸º**æƒè¡¡å‚æ•°**ï¼Œè¯¥å‚æ•°è¡¡é‡å¤šæ ·åŒ–æƒ©ç½šçš„æƒé‡ã€‚

çŸ©é˜µK è¢«ç§°ä½œ DPP kernelï¼Œæ˜¯ä¸€ä¸ª ğ‘Ã—ğ‘çš„å®å¯¹ç§°æ–¹é˜µã€‚

>  K~B~æ˜¯æ ¹æ®Bä¸­çš„å…ƒç´ ä» ğ¾ä¸­æŒ‰è¡ŒæŒ‰åˆ—ç´¢å¼•å¾—åˆ°çš„æ–¹é˜µï¼Œä¹Ÿå³K~B~æ˜¯ ğ¾çš„ä¸»å­å¼
>
>  > ä¸»å­å¼:åœ¨n é˜¶è¡Œåˆ—å¼ä¸­ï¼Œé€‰å–è¡Œå·ï¼ˆå¦‚ 1ã€3ã€7è¡Œï¼‰ï¼Œå†é€‰å–ä¸è¡Œå·ç›¸åŒçš„åˆ—å·ï¼ˆ1ã€3ã€7 åˆ—ï¼‰ï¼Œåˆ™è¡Œæ•°å’Œåˆ—æ•°éƒ½ä¸ºiä¸ªçš„è¡Œåˆ—å¼å³ä¸ºné˜¶è¡Œåˆ—å¼çš„ié˜¶ä¸»å­å¼
>
>  det(K~B~) æ˜¯çŸ©é˜µK~B~çš„è¡Œåˆ—å¼å€¼ã€‚
>
>  **ğ¾ çš„å…ƒç´  ğ¾ğ‘–ğ‘— å¯ä»¥çœ‹åšé›†åˆÎ¸ä¸­ç¬¬ğ‘–,ğ‘—ä¸ªå…ƒç´ ä¹‹é—´çš„ç›¸ä¼¼åº¦**
>
>  ğ¾ğ‘–ğ‘– è¶Šå¤§çš„æ ·æœ¬ï¼Œè¢«é‡‡æ ·å‡ºæ¥çš„æ¦‚ç‡è¶Šå¤§
>
>  ğ¾ğ‘–ğ‘—è¶Šå¤§çš„çš„ä¸¤ä¸ªæ ·æœ¬ {ğ‘–,ğ‘—} è¶Šç›¸ä¼¼ï¼Œ
>
>  è¢«åŒæ—¶é‡‡æ ·å‡ºæ¥çš„æ¦‚ç‡è¶Šä½

**åŸç†**

**MLä¸­å­é›†é€‰æ‹©çš„ç›®æ ‡**æ˜¯ä»Ground setä¸­é€‰æ‹©**é«˜è´¨é‡ä½†å¤šæ ·åŒ–**çš„itemså­é›†, è¿™ç§é«˜è´¨é‡å’Œå¤šæ ·æ€§çš„å¹³è¡¡åœ¨MLä¸­é€šå¸¸ä½¿ç”¨DPPæ¥ä¿æŒ, å…¶ä¸­DPPèµ‹äºˆå­é›†ä¸Šçš„åˆ†å¸ƒä½¿**é€‰æ‹©ä¸¤ä¸ªç›¸ä¼¼é¡¹çš„æ¦‚ç‡æ˜¯åç›¸å…³**çš„.

DPPå°±æ˜¯ä¸€ä¸ªæŠ½æ ·æ–¹æ³•: ä¸¤ä¸ªå…ƒç´ ä½œä¸ºå­é›†è¢«**æŠ½å–çš„æ¦‚ç‡**ä¸ä»…å’Œå•ä¸€å…ƒç´ è¢«æŠ½å–çš„æ¦‚ç‡ç›¸å…³,è¿˜å’Œè¿™ä¸¤ä¸ªå…ƒç´ çš„ç›¸å…³æ€§æœ‰å…³ã€‚**å•ä¸€å…ƒç´ è¢«é€‰æ‹©çš„æ¦‚ç‡è¶Šå¤§ï¼ŒåŒæ—¶å…ƒç´ ä¹‹é—´çš„ç›¸ä¼¼åº¦è¶Šä½($Kii, Kjj$å¤§,$Kij$å°), è¿™ä¸ªé›†åˆè¢«é€‰æ‹©çš„æ¦‚ç‡è¶Šé«˜**

å­˜åœ¨ä¸€ä¸ªè¡Œåˆ—å¼å¯ä»¥åˆ»ç”»ä»»æ„å­é›†è¢«é€‰ä¸­çš„æ¦‚ç‡, è¿™ä¸ªè¡Œåˆ—å¼çš„è‹¥å¹²è¡Œåˆ—ä¸»å­å¼æ­£å¥½å¯¹åº”å­é›†è¢«é€‰ä¸­æ¦‚ç‡, é‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹å«**è¡Œåˆ—å¼è¿‡ç¨‹**

**åº”ç”¨**

1. æ¨èç³»ç»Ÿå¤šæ ·æ€§æå‡çš„ç®—æ³•

   > 0.The_Use_MMR_Diversity_Based_LTMIR
   >
   > mmrç®—æ³• ï¼ˆdiversityç”±æ•´ä½“çš„ç›¸ä¼¼åº¦çš„è´Ÿæ•°æ„é€ , maxå–å€¼ä¹Ÿæ˜¯greedyæ€æƒ³ï¼‰
   >
   > 1.k-DPPs: Fixed-Size Determinantal Point Processes
   >
   > é™å®šå­é›†å…ƒç´ ä¸ªæ•°ä¸ºK
   >
   > 2.Fast Greedy MAP Inference for Determinantal Point Process to Improve Recommendation Diversity
   >
   > å¦‚ä½•æ„é€ åŠæ­£å®šçŸ©é˜µLï¼Œ fiéšå‘é‡ä¸éœ€è¦æ„é€ 

2. è§„èŒƒGANçš„generator, ä½¿ç”Ÿæˆæ•°æ®æ›´åŠ diverse, ç¼“è§£mode collapse

3. å¦‚æœå·²çŸ¥ä¸€ä¸ªè¿‡ç¨‹æ˜¯DPPè¿‡ç¨‹, åˆ™å¯çŸ¥å…¶è¡Œåˆ—å¼, å¯å¯¹å…¶è¿›è¡Œåˆ†å¸ƒæ›´å‡åŒ€çš„é‡‡æ ·

**ä¾‹å­**

i, jå­é›†è¢«é€‰ä¸­æ¦‚ç‡è®¡ç®—:																					

![image-20200302120126678](/img/in-post/20_03/image-20200302120126678.png)

> i,jçš„ç›¸å…³æ€§è¶Šå¤§æ—¶, det(K(Î²i, Î²j))è¶Šå°, i,jåŒæ—¶é€‰æ‹©çš„æ¦‚ç‡p({i,j})å°±è¶Šå°

äºŒç»´å¹³é¢éšæœºé‡‡æ ·:

![image-20200302120120989](/img/in-post/20_03/image-20200302120120989.png)



**Q: ä¸åŒçš„å› å­å°±å¯ä»¥diverse??(é«˜äº®è¡¨ç¤ºå­˜ç–‘)**

A: å°†ä¸¤ä¸ªç±»ä¼¼ç‰¹å¾å¼ºåˆ¶åˆ†é…ç»™ä¸¤ä¸ªé€‰æ‹©åˆ°çš„ä¸åŒçš„factors, æ­¤æ—¶æ¯ä¸ªFactorå¯ä»£è¡¨ä¸€ä¸ªfeature

==Q: factors æ˜¯ä»€ä¹ˆå½¢å¼çš„?==



Q: DPPå¦‚ä½•å®ç°çš„

A: â‘ æ ¸çŸ©é˜µK å¯ä»¥è¡¨ç¤ºç›¸å…³æ€§ â‘¡é€‰å–ç›¸å…³æ€§ä½çš„factorsæ¥å¯¹HSIçš„featuresè¿›è¡Œè¡¨ç¤º

## C. DPP-Based Structured Loss for MS-CNNs

é€šè¿‡**å¤šæ ·åŒ–ï¼ˆdiversificationï¼‰**ï¼Œä¸åŒçš„å› å­(factors)å€¾å‘äºå¯¹ä¸åŒçš„ç‰¹å¾(features)åšå‡ºååº”, å¯ä»¥æ ¹æ®å›¾åƒå»ºæ¨¡æ›´å¤šçš„ç‰¹å¾(features)ã€‚å› æ­¤éœ€è¦åŠ å…¥ä¿ƒè¿›å¤šæ ·æ€§çš„å…ˆéªŒ(diversity-promoting priors)ã€‚

ä¸ºäº†ä½¿å­¦ä¹ åˆ°çš„**åº¦é‡å‚æ•°å› å­å¤šæ ·åŒ–**ï¼Œå¹¶è¿›ä¸€æ­¥æé«˜æ·±åº¦åº¦é‡çš„è¡¨ç¤ºèƒ½åŠ›ï¼Œæå‡ºäº†ä¸€ç§**åŸºäºDPPçš„ç»“æ„æŸå¤±**, å¯¹å­¦ä¹ åˆ°çš„åº¦é‡å‚æ•°å› å­æ–½åŠ ç¡®å®šæ€§ç‚¹è¿‡ç¨‹ï¼ˆDPPï¼‰å…ˆéªŒï¼Œä»¥**é¼“åŠ±å­¦ä¹ åˆ°çš„åº¦é‡å› å­ç›¸äº’æ’æ–¥**ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œä½¿ç”¨è¿™ç§**å…·æœ‰ç‰¹æ®Šç»“æ„æŸå¤±çš„æ·±åº¦åº¦é‡å­¦ä¹ æ–¹æ³•**ï¼Œä»¥**è”åˆè®­ç»ƒ**æ‰€æå‡ºçš„æ¨¡å‹ã€‚

åº¦é‡å‚æ•°å› å­Bå¯ä»¥é€šè¿‡æœ€å¤§åéªŒæ¦‚ç‡(MAP)ä¼°è®¡ï¼š![image-20200302122417727](/img/in-post/20_03/image-20200302122417727.png)

>  å…¶ä¸­Xæ˜¯è®­ç»ƒæ ·æœ¬çš„é›†åˆã€‚
>
>  **DPP prior**ä½“ç°åœ¨ p(B|X) ä¸Š, ä¸ºå·²çŸ¥é€‰ä¸­çš„è®­ç»ƒæ ·æœ¬Xä»¥åé€‰ä¸­Bçš„æ¦‚ç‡

ç­‰æ•ˆå¯¹æ•°ä¼¼ç„¶æ–¹ç¨‹å¯è¡¨ç¤ºä¸º:

![image-20200302122427819](/img/in-post/20_03/image-20200302122427819.png)

è½¬åŒ–ä¸ºçº¦æŸä¼˜åŒ–:

![image-20200302122640399](/img/in-post/20_03/image-20200302122640399.png)

é€šè¿‡é€šè¿‡æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°ï¼Œé‡æ–°åŒ–ä¸ºæ— çº¦æŸä¼˜åŒ–:

![image-20200302122648104](/img/in-post/20_03/image-20200302122648104.png)

ç”¨äºè®­ç»ƒMS-CNNçš„**åŸºäºDPPçš„ç»“æ„æŸå¤±** :

![image-20200302122652956](/img/in-post/20_03/image-20200302122652956.png)

## D. Optimization

é€šè¿‡éšæœºæ¢¯åº¦ä¸‹é™æ–¹æ³•è”åˆè®­ç»ƒMS-CNNå’Œæ·±åº¦åº¦é‡ã€‚è®­ç»ƒè¿‡ç¨‹å¯ä»¥çœ‹ä½œæ˜¯æœ€å°åŒ–åŸºäºDPPçš„ç»“æ„æŸå¤±ã€‚Wè¡¨ç¤ºMS-CNNä¸­çš„å‚æ•°, Bè¡¨ç¤ºåº¦é‡å‚æ•°å› å­ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼°ç®—æ‰€æå‡ºæ¨¡å‹ä¸­çš„å‚æ•°

![image-20200302123010188](/img/in-post/20_03/image-20200302123010188.png)

åŸºäºDPPçš„ç»“æ„åŒ–æŸå¤±Lç›¸å¯¹äºåº¦é‡å› å­Bçš„æ¢¯åº¦å¯ä»¥è®¡ç®—ä¸º: 

![image-20201214182447787](/img/in-post/20_07/image-20201214182447787.png)

# Summary

è¯¥æ¨¡å‹é€šè¿‡ç¡®å®šæ€§ç‚¹è¿‡ç¨‹ï¼ˆDPPï¼‰å…ˆéªŒè€Œéç‹¬ç«‹å…ˆéªŒæ¥ä½¿æ·±åº¦åº¦é‡å¤šæ ·åŒ–, å¼€å‘äº†ä¸€ç§å…·æœ‰**å¤šå°ºåº¦å·ç§¯å’Œå¤šæ ·åŒ–åº¦é‡çš„CNN**ï¼Œä»¥è·å¾—é«˜å…‰è°±å›¾åƒåˆ†ç±»çš„åˆ¤åˆ«ç‰¹å¾ã€‚

åŸºäºDPPçš„ç»“æ„åŒ–æŸå¤±çš„å­¦ä¹ æ¨¡å‹ç”¨äºä»é«˜å…‰è°±å›¾åƒä¸­æå–ç‰¹å¾**å¾®è°ƒ**æ¨¡å‹**ï¼Œ**ç„¶åä½¿ç”¨Softmaxåˆ†ç±»å™¨ç”¨äºåˆ†ç±»**ã€‚**

![image-20200302123035175](/img/in-post/20_03/image-20200302123035175.png)

==Q: featureså’ŒMetricä»€ä¹ˆæ—¶å€™è¿›è¡Œè½¬æ¢çš„==

A: åœ¨MS-CNNä¸­, æœ€åä¸€å±‚è¢«è®­ç»ƒä¸ºå…¨è¿æ¥å±‚çš„Metric Transformationä¾¿æ˜¯ç”±featuresâ†’Metric factors, ä¹‹åä½¿ç”¨åŸºäºDPPå…ˆéªŒçš„ç»“æ„æŸå¤±è¿›è¡Œå¾®è°ƒ, ==**é¼“åŠ±Metric factorsç›¸äº’æ’æ–¥**==, ä½¿æ¨¡å‹å…·æœ‰æ›´å¥½çš„è¡¨ç¤ºèƒ½åŠ›.

Q: Metric transformationå’Œfully connectionä»€ä¹ˆåŒºåˆ«?



Q: å‚æ•°W å’Œå‚æ•°B , Wå‰åéƒ½æœ‰å—, Bæ˜¯ä»€ä¹ˆå½¢å¼?

A: Wæ˜¯MS-CNNä¸­çš„å‚æ•°, Bæ˜¯åº¦é‡å‚æ•°å› å­. éƒ½é€šè¿‡**éšæœºæ¢¯åº¦ä¸‹é™æ³•**è¿›è¡Œæ›´æ–°

# Result

##Â A.Computational Performance

![image-20200302123208238](/img/in-post/20_03/image-20200302123208238.png)

> For pre-training procedure:
>
>  the training epoch, the base learning rate, the weight decay, and the momentum value 
>
> were set to 20000, 0.0001, 5e-5, and 0.9, respectively.
>
> For fine-tuning procedure: 
>
> the training epoch, the base learning rate, the weight decay, and the momentum value 
>
> were set to 1000, 1e-5, 5e-5, and 0.9, respectively.

> 3-Dé¢‘è°±ç©ºé—´åˆ†ç±»é€šå¸¸éœ€è¦è¾ƒå°‘çš„æ—¶é—´ã€‚åŸå› æ˜¯3-Dåˆ†ç±»ä¸­çš„å‚æ•°å°‘äº1-Då’Œ2-Dåˆ†ç±»ä¸­çš„**å‚æ•°**

## B. Modelâ€™s Diversity

![image-20200302123314790](/img/in-post/20_03/image-20200302123314790.png)

> æ¨¡å‹çš„**å¤šæ ·æ€§**éšç€æƒè¡¡å‚æ•°Î»çš„å¢åŠ è€Œå¢åŠ ã€‚åŸå› æ˜¯ï¼Œè¾ƒå¤§çš„Î»å€¼å¯¼è‡´åº¦é‡å‚æ•°å› æ•°çš„æƒé‡è¾ƒé«˜ï¼Œä»è€Œå¯¼è‡´åº¦é‡å‚æ•°å› æ•°ç›¸äº’æ’æ–¥ã€‚
>
> å¯ä»¥æ˜æ˜¾çœ‹å‡ºï¼Œè¯¥æ–¹æ³•çš„å¤šæ ·æ€§æ¯”Î»è®¾ç½®ä¸º0æ—¶å¤§ã€‚æ¢å¥è¯è¯´ï¼Œ**åŸºäºDPPçš„æ–¹æ³•æ‰€å­¦ä¹ çš„æ¨¡å‹å¯ä»¥å¢åŠ åŸå§‹æ¨¡å‹å¤šæ ·æ€§ã€‚**

## C. Effects of Diversity Weight Î»

![image-20200302123333473](/img/in-post/20_03/image-20200302123333473.png)

> ![image-20201214182740959](/img/in-post/20_07/image-20201214182740959.png)
>
> ä»å››ä¸ªæ•°æ®é›†çš„è¶‹åŠ¿å¯ä»¥çœ‹å‡ºï¼ŒÎ»å€¼è¶Šå¤§ï¼Œåˆ†ç±»ç²¾åº¦è¶Šé«˜ï¼Œè€ŒÎ»å€¼è¿‡å¤§ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚
>
> åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé‡‡ç”¨äº¤å‰éªŒè¯æŠ€æœ¯æ¥é€‰æ‹©åˆé€‚çš„Î»æ¥æ»¡è¶³ä¸åŒä»»åŠ¡çš„ç‰¹æ®Šè¦æ±‚ã€‚
>
> **Î»****æ˜¯æƒè¡¡å‚æ•°**ï¼Œå®ƒè¯´æ˜äº†æ¨¡å‹çš„ä¼˜åŒ–å’Œå¤šæ ·æ€§ä¹‹é—´çš„æƒè¡¡ã€‚ä½†æ˜¯ï¼Œå¤ªå¤§çš„Î»å°†è¿‡å¤šçš„æ³¨æ„åŠ›é›†ä¸­åœ¨æ¨¡å‹çš„**å¤šæ ·æ€§**ä¸Šï¼Œè€Œå¿½ç•¥äº†**ä¼˜åŒ–é¡¹**ï¼Œä»è€Œå¯¼è‡´åˆ†ç±»æ€§èƒ½**ä¸‹é™**ã€‚

## D. Effects of Neighbor Size  

![image-20200302123402241](/img/in-post/20_03/image-20200302123402241.png)

>åœ¨Pavia Universityå’ŒIndian Pinesæ•°æ®ä¸Šï¼Œåˆ†ç±»æ€§èƒ½è¾¾åˆ°**5Ã—5**é‚»å±…å¤§å°æ—¶å‡ ä¹è¾¾åˆ°äº†æœ€ä½³æ€§èƒ½ã€‚ 
> åœ¨Salinaså’ŒKSCæ•°æ®ä¸Šï¼Œåˆ†ç±»æ€§èƒ½ä»¥**9Ã—9**çš„é‚»å±…å¤§å°æ’åæœ€é«˜ã€‚åŸå› æ˜¯Salinaså’ŒKSCæ•°æ®åœ¨ä¸åŒç±»åˆ«ä¹‹é—´å…·æœ‰æ˜æ˜¾çš„è¾¹ç•Œï¼Œå› æ­¤ï¼Œè¾ƒå¤§çš„æ ¸å¯ä»¥åˆ©ç”¨æ›´å¤šæœ‰ç”¨çš„ç©ºé—´ä¿¡æ¯ï¼Œå¹¶è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚

## E. Classification Results and Classification Maps

![image-20200302123408751](/img/in-post/20_03/image-20200302123408751.png)

![image-20200302123432385](/img/in-post/20_03/image-20200302123432385.png)

